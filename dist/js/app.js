!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=6)}([function(t,e){var n=function(t,e){return this instanceof n?t instanceof n?t:("string"==typeof t&&(t=this.select(t,e)),t&&t.nodeName&&(t=[t]),void(this.nodes=this.slice(t))):new n(t,e)};n.prototype={get length(){return this.nodes.length}},n.prototype.nodes=[],n.prototype.addClass=function(){return this.eacharg(arguments,function(t,e){t.classList.add(e)})},n.prototype.adjacent=function(t,e,r){return"number"==typeof e&&(e=0===e?[]:new Array(e).join().split(",").map(Number.call,Number)),this.each(function(o,i){var s=document.createDocumentFragment();n(e||{}).map(function(e,r){var s="function"==typeof t?t.call(this,e,r,o,i):t;return"string"==typeof s?this.generate(s):n(s)}).each(function(t){this.isInPage(t)?s.appendChild(n(t).clone().first()):s.appendChild(t)}),r.call(this,o,s)})},n.prototype.after=function(t,e){return this.adjacent(t,e,function(t,e){t.parentNode.insertBefore(e,t.nextSibling)})},n.prototype.append=function(t,e){return this.adjacent(t,e,function(t,e){t.appendChild(e)})},n.prototype.args=function(t,e,n){return"function"==typeof t&&(t=t(e,n)),"string"!=typeof t&&(t=this.slice(t).map(this.str(e,n))),t.toString().split(/[\s,]+/).filter(function(t){return t.length})},n.prototype.array=function(t){t=t;var e=this;return this.nodes.reduce(function(r,o,i){var s;return t?((s=t.call(e,o,i))||(s=!1),"string"==typeof s&&(s=n(s)),s instanceof n&&(s=s.nodes)):s=o.innerHTML,r.concat(!1!==s?s:[])},[])},n.prototype.attr=function(t,e,n){return n=n?"data-":"",this.pairs(t,e,function(t,e){return t.getAttribute(n+e)},function(t,e,r){t.setAttribute(n+e,r)})},n.prototype.before=function(t,e){return this.adjacent(t,e,function(t,e){t.parentNode.insertBefore(e,t)})},n.prototype.children=function(t){return this.map(function(t){return this.slice(t.children)}).filter(t)},n.prototype.clone=function(){return this.map(function(t,e){var n=t.cloneNode(!0),r=this.getAll(n);return this.getAll(t).each(function(t,e){for(var n in this.mirror)this.mirror[n]&&this.mirror[n](t,r.nodes[e])}),n})},n.prototype.getAll=function(t){return n([t].concat(n("*",t).nodes))},n.prototype.mirror={},n.prototype.mirror.events=function(t,e){if(t._e)for(var r in t._e)t._e[r].forEach(function(t){n(e).on(r,t)})},n.prototype.mirror.select=function(t,e){n(t).is("select")&&(e.value=t.value)},n.prototype.mirror.textarea=function(t,e){n(t).is("textarea")&&(e.value=t.value)},n.prototype.closest=function(t){return this.map(function(e){do{if(n(e).is(t))return e}while((e=e.parentNode)&&e!==document)})},n.prototype.data=function(t,e){return this.attr(t,e,!0)},n.prototype.each=function(t){return this.nodes.forEach(t.bind(this)),this},n.prototype.eacharg=function(t,e){return this.each(function(n,r){this.args(t,n,r).forEach(function(t){e.call(this,n,t)},this)})},n.prototype.empty=function(){return this.each(function(t){for(;t.firstChild;)t.removeChild(t.firstChild)})},n.prototype.filter=function(t){var e=function(e){return e.matches=e.matches||e.msMatchesSelector||e.webkitMatchesSelector,e.matches(t||"*")};return"function"==typeof t&&(e=t),t instanceof n&&(e=function(e){return-1!==t.nodes.indexOf(e)}),n(this.nodes.filter(e))},n.prototype.find=function(t){return this.map(function(e){return n(t||"*",e)})},n.prototype.first=function(){return this.nodes[0]||!1},n.prototype.generate=function(t){return/^\s*<tr[> ]/.test(t)?n(document.createElement("table")).html(t).children().children().nodes:/^\s*<t(h|d)[> ]/.test(t)?n(document.createElement("table")).html(t).children().children().children().nodes:/^\s*</.test(t)?n(document.createElement("div")).html(t).children().nodes:document.createTextNode(t)},n.prototype.handle=function(){var t=this.slice(arguments).map(function(t){return"function"==typeof t?function(e){e.preventDefault(),t.apply(this,arguments)}:t},this);return this.on.apply(this,t)},n.prototype.hasClass=function(){return this.is("."+this.args(arguments).join("."))},n.prototype.html=function(t){return void 0===t?this.first().innerHTML||"":this.each(function(e){e.innerHTML=t})},n.prototype.is=function(t){return 0<this.filter(t).length},n.prototype.isInPage=function(t){return t!==document.body&&document.body.contains(t)},n.prototype.last=function(){return this.nodes[this.length-1]||!1},n.prototype.map=function(t){return t?n(this.array(t)).unique():this},n.prototype.not=function(t){return this.filter(function(e){return!n(e).is(t||!0)})},n.prototype.off=function(t){return this.eacharg(t,function(t,e){n(t._e?t._e[e]:[]).each(function(n){t.removeEventListener(e,n)})})},n.prototype.on=function(t,e,r){if("string"==typeof e){var o=e;e=function(t){var e=arguments;n(t.currentTarget).find(o).each(function(n){if(n===t.target||n.contains(t.target)){try{Object.defineProperty(t,"currentTarget",{get:function(){return n}})}catch(n){}r.apply(n,e)}})}}var i=function(t){return e.apply(this,[t].concat(t.detail||[]))};return this.eacharg(t,function(t,e){t.addEventListener(e,i),t._e=t._e||{},t._e[e]=t._e[e]||[],t._e[e].push(i)})},n.prototype.pairs=function(t,e,n,r){if(void 0!==e){var o=t;(t={})[o]=e}return"object"==typeof t?this.each(function(e){for(var n in t)r(e,n,t[n])}):this.length?n(this.first(),t):""},n.prototype.param=function(t){return Object.keys(t).map(function(e){return this.uri(e)+"="+this.uri(t[e])}.bind(this)).join("&")},n.prototype.parent=function(t){return this.map(function(t){return t.parentNode}).filter(t)},n.prototype.prepend=function(t,e){return this.adjacent(t,e,function(t,e){t.insertBefore(e,t.firstChild)})},n.prototype.remove=function(){return this.each(function(t){t.parentNode&&t.parentNode.removeChild(t)})},n.prototype.removeClass=function(){return this.eacharg(arguments,function(t,e){t.classList.remove(e)})},n.prototype.replace=function(t,e){var r=[];return this.adjacent(t,e,function(t,e){r=r.concat(this.slice(e.children)),t.parentNode.replaceChild(e,t)}),n(r)},n.prototype.scroll=function(){return this.first().scrollIntoView({behavior:"smooth"}),this},n.prototype.select=function(t,e){return t=t.replace(/^\s*/,"").replace(/\s*$/,""),/^</.test(t)?n().generate(t):(e||document).querySelectorAll(t)},n.prototype.serialize=function(){var t=this;return this.slice(this.first().elements).reduce(function(e,r){return!r.name||r.disabled||"file"===r.type?e:/(checkbox|radio)/.test(r.type)&&!r.checked?e:"select-multiple"===r.type?(n(r.options).each(function(n){n.selected&&(e+="&"+t.uri(r.name)+"="+t.uri(n.value))}),e):e+"&"+t.uri(r.name)+"="+t.uri(r.value)},"").slice(1)},n.prototype.siblings=function(t){return this.parent().children(t).not(this)},n.prototype.size=function(){return this.first().getBoundingClientRect()},n.prototype.slice=function(t){return t&&0!==t.length&&"string"!=typeof t&&"[object Function]"!==t.toString()?t.length?[].slice.call(t.nodes||t):[t]:[]},n.prototype.str=function(t,e){return function(n){return"function"==typeof n?n.call(this,t,e):n.toString()}},n.prototype.text=function(t){return void 0===t?this.first().textContent||"":this.each(function(e){e.textContent=t})},n.prototype.toggleClass=function(t,e){return!!e===e?this[e?"addClass":"removeClass"](t):this.eacharg(t,function(t,e){t.classList.toggle(e)})},n.prototype.trigger=function(t){var e=this.slice(arguments).slice(1);return this.eacharg(t,function(t,n){var r,o={bubbles:!0,cancelable:!0,detail:e};try{r=new window.CustomEvent(n,o)}catch(t){(r=document.createEvent("CustomEvent")).initCustomEvent(n,!0,!0,e)}t.dispatchEvent(r)})},n.prototype.unique=function(){return n(this.nodes.reduce(function(t,e){return null!=e&&!1!==e&&-1===t.indexOf(e)?t.concat(e):t},[]))},n.prototype.uri=function(t){return encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},n.prototype.wrap=function(t){return this.map(function(e){return n(t).each(function(t){(function(t){for(;t.firstElementChild;)t=t.firstElementChild;return n(t)})(t).append(e.cloneNode(!0)),e.parentNode.replaceChild(t,e)})})},"object"==typeof t&&t.exports&&(t.exports=n,t.exports.u=n)},function(t,e,n){"use strict";t.exports={IDLE:0,SELECTING_RAILROAD:1,SELECTING_START:2,SELECTING_END:3}},function(t,e,n){"use strict";const r=n(0);t.exports.searchItem=((t,e)=>{const n=r("<span>").addClass("name-primary").text(t),o=r("<span>").addClass("name-secondary").text(e),i=r("<li>").addClass("item-item search-item");return i.append(n).append(o),i}),t.exports.plotItem=((t,e,n="#000000",o=1)=>{const i=r("<button>").addClass("action-delete").text("삭제"),s=r("<button>").addClass("action-color").html(`색 (<var>${n}</var>)`),a=r("<button>").addClass("action-width").html(`두께 (<var>${o}</var>)`),c=r("<div>").addClass("plot-controls");c.append(i).append(s).append(a);const l=r("<span>").addClass("name-primary").text(t),u=r("<span>").addClass("name-secondary").text(e),h=r("<li>").addClass("item-item plot-item");return h.append(l).append(u).append(c),h})},function(t,e,n){var r,o=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function o(t,e){if(!r[t]){r[t]={};for(var n=0;n<t.length;n++)r[t][t.charAt(n)]=n}return r[t][e]}var i={compressToBase64:function(t){if(null==t)return"";var n=i._compress(t,6,function(t){return e.charAt(t)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:i._decompress(t.length,32,function(n){return o(e,t.charAt(n))})},compressToUTF16:function(e){return null==e?"":i._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:i._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=i.compress(t),n=new Uint8Array(2*e.length),r=0,o=e.length;r<o;r++){var s=e.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(e){if(null===e||void 0===e)return i.decompress(e);for(var n=new Array(e.length/2),r=0,o=n.length;r<o;r++)n[r]=256*e[2*r]+e[2*r+1];var s=[];return n.forEach(function(e){s.push(t(e))}),i.decompress(s.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":i._compress(t,6,function(t){return n.charAt(t)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),i._decompress(t.length,32,function(e){return o(n,t.charAt(e))}))},compress:function(e){return i._compress(e,16,function(e){return t(e)})},_compress:function(t,e,n){if(null==t)return"";var r,o,i,s={},a={},c="",l="",u="",h=2,p=3,d=2,f=[],m=0,y=0;for(i=0;i<t.length;i+=1)if(c=t.charAt(i),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=p++,a[c]=!0),l=u+c,Object.prototype.hasOwnProperty.call(s,l))u=l;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(r=0;r<d;r++)m<<=1,y==e-1?(y=0,f.push(n(m)),m=0):y++;for(o=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o>>=1}else{for(o=1,r=0;r<d;r++)m=m<<1|o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o=0;for(o=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o>>=1}0==--h&&(h=Math.pow(2,d),d++),delete a[u]}else for(o=s[u],r=0;r<d;r++)m=m<<1|1&o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o>>=1;0==--h&&(h=Math.pow(2,d),d++),s[l]=p++,u=String(c)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(r=0;r<d;r++)m<<=1,y==e-1?(y=0,f.push(n(m)),m=0):y++;for(o=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o>>=1}else{for(o=1,r=0;r<d;r++)m=m<<1|o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o=0;for(o=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o>>=1}0==--h&&(h=Math.pow(2,d),d++),delete a[u]}else for(o=s[u],r=0;r<d;r++)m=m<<1|1&o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o>>=1;0==--h&&(h=Math.pow(2,d),d++)}for(o=2,r=0;r<d;r++)m=m<<1|1&o,y==e-1?(y=0,f.push(n(m)),m=0):y++,o>>=1;for(;;){if(m<<=1,y==e-1){f.push(n(m));break}y++}return f.join("")},decompress:function(t){return null==t?"":""==t?null:i._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,n,r){var o,i,s,a,c,l,u,h=[],p=4,d=4,f=3,m="",y=[],g={val:r(0),position:n,index:1};for(o=0;o<3;o+=1)h[o]=o;for(s=0,c=Math.pow(2,2),l=1;l!=c;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=r(g.index++)),s|=(a>0?1:0)*l,l<<=1;switch(s){case 0:for(s=0,c=Math.pow(2,8),l=1;l!=c;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=r(g.index++)),s|=(a>0?1:0)*l,l<<=1;u=t(s);break;case 1:for(s=0,c=Math.pow(2,16),l=1;l!=c;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=r(g.index++)),s|=(a>0?1:0)*l,l<<=1;u=t(s);break;case 2:return""}for(h[3]=u,i=u,y.push(u);;){if(g.index>e)return"";for(s=0,c=Math.pow(2,f),l=1;l!=c;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=r(g.index++)),s|=(a>0?1:0)*l,l<<=1;switch(u=s){case 0:for(s=0,c=Math.pow(2,8),l=1;l!=c;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=r(g.index++)),s|=(a>0?1:0)*l,l<<=1;h[d++]=t(s),u=d-1,p--;break;case 1:for(s=0,c=Math.pow(2,16),l=1;l!=c;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=n,g.val=r(g.index++)),s|=(a>0?1:0)*l,l<<=1;h[d++]=t(s),u=d-1,p--;break;case 2:return y.join("")}if(0==p&&(p=Math.pow(2,f),f++),h[u])m=h[u];else{if(u!==d)return null;m=i+i.charAt(0)}y.push(m),h[d++]=i+m.charAt(0),i=m,0==--p&&(p=Math.pow(2,f),f++)}}};return i}();void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r)},function(t,e,n){"use strict";function r(t,e,n,r){const o=(n-t)*Math.PI/180,i=(r-e)*Math.PI/180,s=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))}t.exports={geo:{length:function(t){if(t.length<2)return 0;let e=0;for(let n=1;n<t.length;n++)e+=r(t[n-1][1],t[n-1][0],t[n][1],t[n][0]);return e},distance:r,compare:function(t,e,n,r){return Math.round(1e5*t)===Math.round(1e5*n)&&Math.round(1e5*e)===Math.round(1e5*r)}},hash32:function(t){let e=5381,n=t.length;for(;n;)e=33*e^t.charCodeAt(--n);return e>>>0}}},function(t,e,n){t.exports=function(){"use strict";var t="millisecond",e="second",n="minute",r="hour",o="day",i="week",s="month",a="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})(.*?(\d{1,2}):(\d{1,2}):(\d{1,2}))?.?(\d{1,3})?$/,l=/\[.*?\]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,u={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},h=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},p={padStart:h,padZoneStr:function(t){var e=Math.abs(t),n=Math.floor(e/60),r=e%60;return(t<=0?"+":"-")+h(n,2,"0")+":"+h(r,2,"0")},monthDiff:function(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(n,"months"),o=e-r<0,i=t.clone().add(n+(o?-1:1),"months");return Number(-(n+(e-r)/(o?r-i:i-r)))},absFloor:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},prettyUnit:function(c){return{M:s,y:a,w:i,d:o,h:r,m:n,s:e,ms:t}[c]||String(c||"").toLowerCase().replace(/s$/,"")},isUndefined:function(t){return void 0===t}},d="en",f={};f[d]=u;var m=function(t){return t instanceof w},y=function(t,e,n){var r;if(!t)return null;if("string"==typeof t)f[t]&&(r=t),e&&(f[t]=e,r=t);else{var o=t.name;f[o]=t,r=o}return n||(d=r),r},g=function(t,e){if(m(t))return t.clone();var n=e||{};return n.date=t,new w(n)},v=function(t,e){return g(t,{locale:e.$L})},S=p;S.parseLocale=y,S.isDayjs=m,S.wrapper=v;var w=function(){function u(t){this.parse(t)}var h=u.prototype;return h.parse=function(t){var e,n;this.$d=null===(e=t.date)?new Date(NaN):S.isUndefined(e)?new Date:e instanceof Date?e:"string"==typeof e&&/.*[^Z]$/i.test(e)&&(n=e.match(c))?new Date(n[1],n[2]-1,n[3]||1,n[5]||0,n[6]||0,n[7]||0,n[8]||0):new Date(e),this.init(t)},h.init=function(t){this.$y=this.$d.getFullYear(),this.$M=this.$d.getMonth(),this.$D=this.$d.getDate(),this.$W=this.$d.getDay(),this.$H=this.$d.getHours(),this.$m=this.$d.getMinutes(),this.$s=this.$d.getSeconds(),this.$ms=this.$d.getMilliseconds(),this.$L=this.$L||y(t.locale,null,!0)||d},h.$utils=function(){return S},h.isValid=function(){return!("Invalid Date"===this.$d.toString())},h.$compare=function(t){return this.valueOf()-g(t).valueOf()},h.isSame=function(t){return 0===this.$compare(t)},h.isBefore=function(t){return this.$compare(t)<0},h.isAfter=function(t){return this.$compare(t)>0},h.year=function(){return this.$y},h.month=function(){return this.$M},h.day=function(){return this.$W},h.date=function(){return this.$D},h.hour=function(){return this.$H},h.minute=function(){return this.$m},h.second=function(){return this.$s},h.millisecond=function(){return this.$ms},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(t,c){var l=this,u=!!S.isUndefined(c)||c,h=function(t,e){var n=v(new Date(l.$y,e,t),l);return u?n:n.endOf(o)},p=function(t,e){return v(l.toDate()[t].apply(l.toDate(),u?[0,0,0,0].slice(e):[23,59,59,999].slice(e)),l)};switch(S.prettyUnit(t)){case a:return u?h(1,0):h(31,11);case s:return u?h(1,this.$M):h(0,this.$M+1);case i:return h(u?this.$D-this.$W:this.$D+(6-this.$W),this.$M);case o:case"date":return p("setHours",0);case r:return p("setMinutes",1);case n:return p("setSeconds",2);case e:return p("setMilliseconds",3);default:return this.clone()}},h.endOf=function(t){return this.startOf(t,!1)},h.$set=function(i,c){switch(S.prettyUnit(i)){case o:this.$d.setDate(this.$D+(c-this.$W));break;case"date":this.$d.setDate(c);break;case s:this.$d.setMonth(c);break;case a:this.$d.setFullYear(c);break;case r:this.$d.setHours(c);break;case n:this.$d.setMinutes(c);break;case e:this.$d.setSeconds(c);break;case t:this.$d.setMilliseconds(c)}return this.init(),this},h.set=function(t,e){return this.clone().$set(t,e)},h.add=function(t,c){var l=this;t=Number(t);var u,h=S.prettyUnit(c),p=function(e,n){var r=l.set("date",1).set(e,n+t);return r.set("date",Math.min(l.$D,r.daysInMonth()))};if(h===s)return p(s,this.$M);if(h===a)return p(a,this.$y);switch(h){case n:u=6e4;break;case r:u=36e5;break;case o:u=864e5;break;case i:u=6048e5;break;case e:u=1e3;break;default:u=1}var d=this.valueOf()+t*u;return v(d,this)},h.subtract=function(t,e){return this.add(-1*t,e)},h.format=function(t){var e=this,n=t||"YYYY-MM-DDTHH:mm:ssZ",r=S.padZoneStr(this.$d.getTimezoneOffset()),o=this.$locale(),i=o.weekdays,s=o.months,a=function(t,e,n,r){return t&&t[e]||n[e].substr(0,r)};return n.replace(l,function(t){if(t.indexOf("[")>-1)return t.replace(/\[|\]/g,"");switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return String(e.$y);case"M":return String(e.$M+1);case"MM":return S.padStart(e.$M+1,2,"0");case"MMM":return a(o.monthsShort,e.$M,s,3);case"MMMM":return s[e.$M];case"D":return String(e.$D);case"DD":return S.padStart(e.$D,2,"0");case"d":return String(e.$W);case"dd":return a(o.weekdaysMin,e.$W,i,2);case"ddd":return a(o.weekdaysShort,e.$W,i,3);case"dddd":return i[e.$W];case"H":return String(e.$H);case"HH":return S.padStart(e.$H,2,"0");case"h":case"hh":return 0===e.$H?12:S.padStart(e.$H<13?e.$H:e.$H-12,"hh"===t?2:1,"0");case"a":return e.$H<12?"am":"pm";case"A":return e.$H<12?"AM":"PM";case"m":return String(e.$m);case"mm":return S.padStart(e.$m,2,"0");case"s":return String(e.$s);case"ss":return S.padStart(e.$s,2,"0");case"SSS":return S.padStart(e.$ms,3,"0");case"Z":return r;default:return r.replace(":","")}})},h.diff=function(t,c,l){var u=S.prettyUnit(c),h=g(t),p=this-h,d=S.monthDiff(this,h);switch(u){case a:d/=12;break;case s:break;case"quarter":d/=3;break;case i:d=p/6048e5;break;case o:d=p/864e5;break;case r:d=p/36e5;break;case n:d=p/6e4;break;case e:d=p/1e3;break;default:d=p}return l?d:S.absFloor(d)},h.daysInMonth=function(){return this.endOf(s).$D},h.$locale=function(){return f[this.$L]},h.locale=function(t,e){var n=this.clone();return n.$L=y(t,e,!0),n},h.clone=function(){return v(this.toDate(),this)},h.toDate=function(){return new Date(this.$d)},h.toArray=function(){return[this.$y,this.$M,this.$D,this.$H,this.$m,this.$s,this.$ms]},h.toJSON=function(){return this.toISOString()},h.toISOString=function(){return this.toDate().toISOString()},h.toObject=function(){return{years:this.$y,months:this.$M,date:this.$D,hours:this.$H,minutes:this.$m,seconds:this.$s,milliseconds:this.$ms}},h.toString=function(){return this.$d.toUTCString()},u}();return g.extend=function(t,e){return t(e,w,g),g},g.locale=y,g.isDayjs=m,g.en=f[d],g}()},function(t,e,n){"use strict";var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();const o=n(3),i=n(0);i.prototype.removeAttr=function(t){this.each(e=>e.removeAttribute(t))};const s=n(7);var a=n(11);const c=a.REV_RAILROAD,l=a.REV_STATION,u=n(1),h=(...t)=>{console.log(`[${(new Date).toLocaleString()}]`,...t)};class p{async start(){i(".loading").addClass("active"),await this.initJRPlotter(),this.initGoogleMaps(),this.initEvents(),this.state=u.IDLE,this.plots=[],i(".loading").removeClass("active")}async initJRPlotter(){const t=JSON.parse(localStorage.getItem("revision"))||{railroad:0,station:0},e=localStorage.getItem("railroad"),n=localStorage.getItem("station");let r,i;if(t.railroad<c||!e){h("railroad cache is outdated, downloading");const t=await fetch("dist/data/railroad.json?r="+c),e=await t.text();r=JSON.parse(e),h("compressing and saving railroad cache");const n=o.compressToUTF16(e);localStorage.setItem("railroad",n)}else{h("railroad cache is up to date, decompressing");const t=o.decompressFromUTF16(e);r=JSON.parse(t)}if(t.station<l||!n){h("station cache is outdated, downloading");const t=await fetch("dist/data/station.json?r="+l),e=await t.text();i=JSON.parse(e),h("compressing and saving station cache, compressing");const n=o.compressToUTF16(e);localStorage.setItem("station",n)}else{h("station cache is up to date, decompressing");const t=o.decompressFromUTF16(n);i=JSON.parse(t)}h("JRP data loaded");const a={railroad:c,station:l};localStorage.setItem("revision",JSON.stringify(a)),h("Initializing JRPlotter"),this.JRP=new s(r,i),h("everything has loaded, ready to go!")}initGoogleMaps(){this.map=new google.maps.Map(i("#google-map").first(),{center:{lat:37,lng:137},zoom:5})}initEvents(){i(".button-hide-hovers").on("click",()=>{i("body").addClass("hovers-hidden")}),i(".button-show-hovers").on("click",()=>{i("body").removeClass("hovers-hidden")}),i(".search-input input").on("input",this.eventSearchInput.bind(this)),i(".state-cancel").on("click",this.resetSearchState.bind(this)),i(".modal .modal-close").on("click",t=>{i(t.target).closest(".modal").removeClass("active")}),i(".button-show-modal-import-jrp").on("click",this.showModalImportJrp.bind(this)),i(".modal-action-import-jrp").on("click",this.eventModalImportJrp.bind(this)),i(".button-show-modal-export-jrp").on("click",this.showModalExportJrp.bind(this)),i(".button-show-modal-export-polyline").on("click",this.showModalExportPolyline.bind(this)),i(".modal-export-polyline input").on("input",this.showModalExportPolyline.bind(this)),i(".button-show-modal-export-kml").on("click",this.showModalExportKml.bind(this))}newGooglePolyline(t,e,n){return new google.maps.Polyline({path:t.map(([t,e])=>({lat:e,lng:t})),strokeColor:e,strokeWeight:n,map:this.map})}newGoogleMarker(t,e){var n=r(t,2);const o=n[0],i=n[1];return new google.maps.Marker({position:{lat:i,lng:o},label:e,map:this.map})}resetSearchState(){i(".search-result").empty(),i(".search-input input").removeAttr("disabled"),i(".search-input input").first().value="",i(".search-state").removeClass("active"),i(".state-current").text(""),i(".state-start").text(""),i(".state-end").text(""),this.state=u.IDLE,this.unsetPreviewRailroads(),this.unsetStateRailroads(),this.unsetPreviewStations(),this.unsetStateStations()}enableSearchState(t){i(".search-state").addClass("active"),i(".state-current").text(t),i(".search-input input").attr("disabled","disabled")}setSearchStateStation(t){this.state===u.SELECTING_START?i(".state-start").text(t):this.state===u.SELECTING_END&&i(".state-end").text(t)}}n(12)(p),n(13)(p),n(14)(p),n(15)(p),n(20);const d=new p;d.start().then(()=>{}).catch(t=>{console.error(t)}),window.app=d},function(t,e,n){"use strict";const r=n(3),o=n(22),i=n(8),s=n(9),a=n(10),c=n(4),l={line:1,series:2,route:3},u={line:1,series:2,route:3,1:"line",2:"series",3:"routes"},h=18;function p(t,e){for(const n of t){let t=!1,r=n.match(/((?:^|[+\-])[^+\-]+)/g);for(const n of r){const r=n.replace(/^[+\-]/,"");let o=!1;for(const t of e)o=o||t.includes(r);t="+"===n[0]?t&&o:"-"===n[0]?t&&!o:t||o}if(t)return!0}return!1}t.exports=class{constructor(t,e){this.railroads=o.feature(t,t.objects.railroads),this.stations=o.feature(e,e.objects.stations),this.railroadHashes=new Map,this.seriesHashes=new Map,this.stationHashes=new Map,this.mapLineStation=new Map,this.mapSeriesStation=new Map;for(let t=0;t<this.railroads.features.length;t++){var n=this.railroads.features[t].properties;const e=n.company,r=n.lineName,o=c.hash32(`${e}ÿ${r}`);this.railroadHashes.has(o)||this.railroadHashes.set(o,{indexes:[],company:e,line:r}),this.railroadHashes.get(o).indexes.push(t)}for(let t=0;t<this.stations.features.length;t++){var r=this.stations.features[t].properties;const e=r.company,n=r.lineName,o=r.groupId,i=r.stationName,s=c.hash32(o);this.stationHashes.has(s)||this.stationHashes.set(s,{index:t,id:o,name:i,company:e,line:n});const a=c.hash32(`${e}ÿ${n}`);this.mapLineStation.has(a)||this.mapLineStation.set(a,[]),this.mapLineStation.get(a).push({index:t,hash:s,id:o,name:i})}for(let t=0;t<s.length;t++){const e=s[t],n=c.hash32(`${e.type}ÿ${e.name}`);this.seriesHashes.set(n,{index:t,type:e.type,name:e.name}),this.mapSeriesStation.set(n,e.stops.map(t=>{const e=this.stationHashes.get(t);return{index:e.index,hash:t,id:e.id,name:e.name}}))}}getRailroadFeatures(t){t=parseInt(t);const e=this.railroadHashes.get(t);return!!e&&e.indexes.map(t=>this.railroads.features[t])}getSeriesFeatures(t){t=parseInt(t);const e=this.seriesHashes.get(t);return!!e&&s[e.index].routes.map(([t,e,n])=>({geometry:{type:"LineString",coordinates:null!==t?this.getRoute("line",t,e,n):[this.getStationFeature(e).geometry.coordinates,this.getStationFeature(n).geometry.coordinates]}}))}searchRailroads(t){const e=[],n=Object.keys(i).filter(e=>e.includes(t)),r=[t].concat(n.map(t=>i[t])).filter((t,e,n)=>n.indexOf(t)===e),o={};return this.railroads.features.filter(t=>{var e=t.properties;const n=e.lineName,o=e.company;return p(r,[n,o])}).forEach(t=>{const n=`${t.properties.company}ÿ${t.properties.lineName}`,r=c.hash32(n);r in o||(o[r]=!0,e.push({type:"line",hash:r,company:t.properties.company,line:t.properties.lineName,features:this.getRailroadFeatures(r)}))}),s.filter(t=>p(r,[t.type,t.name])).forEach(t=>{const n=`${t.type}ÿ${t.name}`,r=c.hash32(n);e.push({type:"series",hash:r,seriesType:t.type,name:t.name,features:this.getSeriesFeatures(r)})}),e.sort((t,e)=>l[t.type]-l[e.type]||t.company&&e.company&&t.company.localeCompare(e.company)||t.line&&e.line&&t.line.localeCompare(e.line)||t.name&&e.name&&t.name.localeCompare(e.name)),e}getStationsFromLine(t){t=parseInt(t);const e=this.mapLineStation.get(t);return!!e&&(e.sort((t,e)=>t.id.localeCompare(e.id)),e)}getStationsFromSeries(t){t=parseInt(t);const e=this.mapSeriesStation.get(t);return e||!1}getStationFeature(t){t=parseInt(t);const e=this.stationHashes.get(t);return!!e&&this.stations.features[e.index]}getRoute(t,e,n,r){let o;"line"===t?o=this.getRailroadFeatures(e):"series"===t&&(o=this.getSeriesFeatures(e));const i=o.map(t=>t.geometry.coordinates),s=this.getStationFeature(n),c=this.getStationFeature(r);if(!s||!c)return null;const l=s.geometry.coordinates,u=c.geometry.coordinates;return a(i,l,u)}decodeJRP1(t){const e=r.decompressFromBase64(t);return JSON.parse(e).map(t=>({type:"line",lineHash:c.hash32(`${t.company}ÿ${t.lineName}`),startHash:c.hash32(t.start),endHash:c.hash32(t.end),color:t.color,width:t.width}))}decodeJRP2(t,e){if(!t.startsWith("JRP2-"))return!1;const n=e(t.slice(5));if(n.length%h!=0)return!1;const r=new ArrayBuffer(n.length),o=new DataView(r);for(let t=0;t<n.length;t++)o.setUint8(t,n.charCodeAt(t));const i=[];for(let t=0;t<n.length;t+=h){const e={type:u[o.getUint8(t+0)],lineHash:o.getUint32(t+1),startHash:o.getUint32(t+5),endHash:o.getUint32(t+9),color:"#"+[o.getUint8(t+13),o.getUint8(t+14),o.getUint8(t+15)].map(t=>t.toString(16).padStart(2,"0")).join(""),width:o.getUint16(t+16)};i.push(e)}return i}encodeJRP2(t,e){const n=new ArrayBuffer(t.length*h),r=new DataView(n);for(let e=0;e<t.length;e++){const n=t[e],o=e*h;r.setUint8(o+0,u[n.type]),r.setUint32(o+1,n.lineHash),r.setUint32(o+5,n.startHash),r.setUint32(o+9,n.endHash);const i=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/,s=n.color.match(i);if(!s)return;r.setUint8(o+13,parseInt(s[1],16)),r.setUint8(o+14,parseInt(s[2],16)),r.setUint8(o+15,parseInt(s[3],16)),r.setUint16(o+16,n.width)}let o="";for(let t=0;t<n.byteLength;t++)o+=String.fromCharCode(r.getUint8(t));return"JRP2-"+e(o)}}},function(t,e,n){"use strict";t.exports={"JR 홋카이도":"北海道旅客鉄道（旧国鉄）","JR 동일본":"東日本旅客鉄道（旧国鉄）","JR 히가시니혼":"東日本旅客鉄道（旧国鉄）","JR 도카이":"東海旅客鉄道（旧国鉄）","JR 토카이":"東海旅客鉄道（旧国鉄）","JR 서일본":"西日本旅客鉄道（旧国鉄）","JR 니시니혼":"西日本旅客鉄道（旧国鉄）","JR 시코쿠":"四国旅客鉄道（旧国鉄）","JR 큐슈":"九州旅客鉄道（旧国鉄）","JR 규슈":"九州旅客鉄道（旧国鉄）","도카이도 신칸센":"東海道新幹線","토카이도 신칸센":"東海道新幹線","산요 신칸센":"山陽新幹線","도호쿠 신칸센":"東北新幹線","토호쿠 신칸센":"東北新幹線","큐슈 신칸센":"九州新幹線","규슈 신칸센":"九州新幹線","조에츠 신칸센":"上越新幹線","조에쓰 신칸센":"上越新幹線","죠에츠 신칸센":"上越新幹線","호쿠리쿠 신칸센":"北陸新幹線","홋카이도 신칸센":"北海道新幹線","御堂筋線":"大阪市+1号線","谷町線":"大阪市+2号線","四つ橋線":"大阪市+3号線","中央線":"大阪市+4号線","千日前線":"大阪市+5号線","堺筋線":"大阪市+6号線","長堀鶴見緑地線":"大阪市+7号線","今里筋線":"大阪市+8号線","空港線":"福岡市+1号線","箱崎線":"福岡市+2号線","七隈線":"福岡市+3号線","선라이즈":"サンライズ","호쿠토":"北斗","카무이":"カムイ","라일락":"ライラック","나리타 익스프레스":"成田エクスプレス","아즈사":"あずさ","슈퍼 아즈사":"あずさ","카이지":"かいじ","후지카와":"ふじかわ","시나노":"しなの","선더버드":"サンダーバード","썬더버드":"サンダーバード","하루카":"はるか","마린라이너":"マリンライナー","마린 라이너":"マリンライナー","시오카제":"しおかぜ","이시즈치":"いしづち","카모메":"かもめ","미도리":"みどり","소닉":"ソニック"}},function(t,e,n){"use strict";t.exports=[{type:"寝台特別急行",name:"サンライズ出雲",routes:[[228138242,3225212912,2299314070],[2219478140,141291071,2956911413],[228193036,3126843284,1418603120],[2717558933,3998945598,1337356671],[382442799,67813783,4032633949],[695920472,679815965,863978937]],stops:[3225212912,3168257878,2299314070,2357047674,2185409079,3685535894,3101898456,3865610867,3318533657,4247791807,103313531,1337356671,1065059231,1421397170,2638891935,3952724249,3553569557,3137483134,863978937]},{type:"寝台特別急行",name:"サンライズ瀬戸",routes:[[228138242,3225212912,2299314070],[2219478140,141291071,2956911413],[228193036,3126843284,1418603120],[2717558933,3998945598,103313531],[null,103313531,743325785],[3337993872,743325785,3790140624],[3703523572,1206522360,707899644],[633008996,3695491420,315709790],[4231993186,26426589,21936574]],stops:[3225212912,3168257878,2299314070,2357047674,2185409079,3685535894,3101898456,3865610867,3318533657,4247791807,103313531,707899644,315709790,21936574]},{type:"特別急行",name:"スーパー北斗",routes:[[3045361225,178389748,3398917910],[3928234613,2793671037,3207582745],[4188800236,681241885,755083896],[3045361225,3701104148,1357426326]],stops:[178389748,653423031,3926331315,1175635196,3547997392,2128157301,3398917910,542821749,2644117086,275046463,3547954747,4114973467,2112964248,2445011070,1357426326]},{type:"特別急行",name:"カムイ・ライラック",routes:[[3045361225,1357426326,1222548978]],stops:[1357426326,840593595,1484318684,462259672,160064986,2546794228,1222548978]},{type:"特別急行",name:"成田エクスプレス (池袋・大宮)",routes:[[48338135,1480191806,1109870970],[1375572286,54159282,65028279],[228138242,4279141649,3623802102],[2943346285,542591640,3873137215],[910822321,2362399249,2906043736]],stops:[1480191806,2561015807,1669380728,1109870970,2867153200,4050561781,65028279,3623802102,1514981023,2586709648,3172361787,2906043736]},{type:"特別急行",name:"成田エクスプレス (高尾・河口湖)",routes:[[48338135,1480191806,1109870970],[1375572286,54159282,65028279],[228138242,4279141649,3623802102],[2943346285,542591640,2586709648],[null,2586709648,3405162462],[3325678932,3405162462,936447163],[null,936447163,1911864699],[3193311681,1911864699,2896453725],[2182606600,3861624026,2225317720]],stops:[1480191806,2561015807,1669380728,1109870970,2867153200,4050561781,65028279,3623802102,1514981023,2586709648,247469183,2688158654,2291587191,2324308255,936447163,314761498,936447163,3021170866,2896453725,382074713,2225317720]},{type:"特別急行",name:"成田エクスプレス (大船・横須賀)",routes:[[48338135,1480191806,1109870970],[1375572286,54159282,65028279],[228138242,4279141649,348024596],[228138242,348024596,3604756467],[null,3604756467,3106358077],[1354493429,3106358077,582706235]],stops:[1480191806,2561015807,1669380728,1109870970,2867153200,4050561781,65028279,3623802102,348024596,3168257878,3555012185,3604756467,2172956030,2804163391,253685112,582706235]},{type:"特別急行",name:"あずさ",routes:[[1375572286,4050561781,3020260212],[910822321,318281241,2237922586],[3325678932,1116412735,2144342683],[412159308,1928322808,1129525695],[989640136,3339802329,969715455]],stops:[4050561781,2124664852,3480183026,318281241,3405162462,2688158654,2291587191,2324308255,936447163,1819215102,1732078064,3315481177,3013294939,1363670878,2508193082,556912056,549655421,2990353340,2111621619,257343794,2144342683,1129525695,1088953041,4144364408,1139422874,268940027,969715455]},{type:"特別急行",name:"かいじ",routes:[[910822321,318281241,2237922586],[3325678932,1116412735,1665865564]],stops:[318281241,3462725429,3405162462,2688158654,2291587191,2324308255,936447163,1819215102,1732078064,3315481177,3013294939,1665865564]},{type:"特別急行",name:"ふじかわ",routes:[[2219478140,3685535894,2185409079],[1414663220,4015101370,1290389457]],stops:[3685535894,3341338137,2185409079,1483445052,57059103,1119594653,1464399417,2165174845,3144130879,1593457534,3541238745,1137913310,1290389457]},{type:"特別急行",name:"しなの",routes:[[621379306,3940540094,1158799993],[412159308,1928322808,1961652061],[2928744060,2781381534,559924378]],stops:[3940540094,3901067005,3731327890,754101787,887858495,2027751993,3256929118,2355331032,1422222937,1158799993,1129525695,1228155313,1260876633,1961652061,559924378]},{type:"特別急行",name:"サンダーバード",routes:[[228193036,3865610867,362289981],[4166633296,1164719991,1054707509],[3567540598,566909561,3690868120],[569451904,3690868120,2172880539],[1635196580,2996040799,110449692]],stops:[3865610867,2197344562,2973736528,2225917911,1043838512,2401719120,767740667,2611027569,2263666480,587525977,2509793746,1435861561,252203006,2460849181,3690868120,2172880539,108918845,1549753590,110449692]},{type:"特別急行",name:"はるか",routes:[[228193036,3126843284,3865610867],[null,3865610867,618317021],[2654504338,618317021,2285032957],[2654504338,2285032957,3761003832],[null,3761003832,2363795708],[2633571807,2363795708,4064958073],[1121458353,3775275229,3473088991]],stops:[3126843284,3398457239,2299101085,399170548,1763840821,1461646135,3369892594,3292587004,362289981,2225917911,2973736528,2197344562,3761003832,2056206932,4064958073,3473088991]},{type:"快速",name:"マリンライナー",routes:[[3337993872,743325785,3790140624],[3703523572,1206522360,707899644],[633008996,3695491420,315709790],[4231993186,26426589,21936574]],stops:[743325785,2661208282,1658519899,1247399900,2162585566,3790140624,1198014651,2121716474,4079173565,707899644,315709790,1150868916,3294844858,1883977721,2379659192,21936574]},{type:"特別急行",name:"しおかぜ",routes:[[3337993872,743325785,3790140624],[3703523572,1206522360,707899644],[633008996,3695491420,232487391],[4231993186,1616565724,385149008]],stops:[743325785,707899644,232487391,941620703,3299334873,1509692378,3660683732,279290492,1626623803,3552198776,1198974365,3345576731,3706925590,545696123,1961053275,385149008]},{type:"特別急行",name:"いしづち",routes:[[4231993186,21936574,385149008]],stops:[21936574,315709790,232487391,941620703,3299334873,1509692378,3660683732,279290492,1626623803,3552198776,1198974365,3345576731,3706925590,545696123,1961053275,385149008]},{type:"特別急行",name:"かもめ",routes:[[2607508661,1506476953,1817898963],[849479797,3030353716,3877232720]],stops:[3628219070,1202870137,1898095704,1817898963,944500599,1529569277,4173273879,3420457234,769198015,1978675539,3877232720]},{type:"特別急行",name:"みどり",routes:[[2607508661,1506476953,1817898963],[849479797,3030353716,4173273879],[1572569719,2218241246,2163777466]],stops:[3628219070,1202870137,1898095704,1817898963,944500599,2008294704,1529569277,4173273879,1196182234,4262359254,2319147647,2163777466]},{type:"特別急行",name:"ソニック",routes:[[2607508661,1202870137,2027256667],[219642915,4223802392,2391789755]],stops:[1202870137,3628219070,2224929149,4221855007,2528535965,9710876,1737216506,3107439612,2759275518,2574608598,2027256667,3280671775,896430584,809984638,1770263729,2108132447,3737447261,136059322,3065715071,400062589,615027741,1883880734,1325634585,1737802907,1269014589,2851476222,2391789755]}]},function(t,e,n){"use strict";var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();const o=n(4),i=-1,s=0,a=1,c=2,l=t=>[t[1],t[0]];function u(t,e){for(let n=0;n<t.length;n++){const r=t[n];for(let t=0;t<r.length;t++)if(o.geo.compare(...r[t],...e))return[n,t,!1]}for(let n=0;n<t.length;n++){const r=t[n];for(let t=0;t<r.length-1;t++){const i=o.geo.distance(...r[t],...e),s=o.geo.distance(...e,...r[t+1]),a=o.geo.distance(...r[t],...r[t+1]);if(Math.round(i+s)===Math.round(a))return[n,t,t+1]}}return!1}t.exports=function(t,e,n){e=l(e),n=l(n);const h=[],p={};for(let e=0,n=t.length;e<n;e++){const n=t[e].slice().map(l);h.push(n),p[e]={}}const d=h.length;let f=!1,m=u(h,e);if(!1===m)return!1;!1!==m[2]&&(f=!0,h[m[0]].splice(m[1],0,e));let y=u(h,n);if(!1===y)return!1;!1!==y[2]&&(f=!0,h[y[0]].splice(y[1],0,n)),f&&(m=u(h,e),y=u(h,n));for(let t=0;t<d;t++)for(let e=0;e<d;e++)for(let n of[0,h[t].length-1])for(let r=0;r<h[e].length;r++)t===e&&n===r||!o.geo.compare(...h[t][n],...h[e][r])||(p[t][n]=[e,r],p[e][r]=[t,n]);const g=function t(e,n,o,l,u=s,h=[]){const p=t.bind(null,e,n);const d=([t,e])=>h.includes(`${t}/${e}`);const f=[];var m=r(o,2);const y=m[0],g=m[1];var v=r(l,2);const S=v[0],w=v[1];y===S&&f.push([[y,g,w]]);h=[...h,`${y}/${g}`];let b=Object.keys(n[y]);b=b.map(t=>parseInt(t));b.sort((t,e)=>t-e);let M=[],E=!1,$=[];for(let t=0;t<b.length;t++){const e=b[t];e<g?M.push(e):g===e?E=n[y][e]:g<e&&$.push(e)}let P=!1,x=!1;M.length&&(P=Math.max(...M));$.length&&(x=Math.min(...$));const k=[y,P];if(!1!==P&&u!==a&&!d(k)){const t=p(k,l,i,h).map(t=>[[y,g,P],...t]);f.push(...t)}if(!1!==E&&!d(E)){const t=p(E,l,c,h);f.push(...t)}const R=[y,x];if(!1!==x&&u!==i&&!d(R)){const t=p(R,l,a,h).map(t=>[[y,g,x],...t]);f.push(...t)}return f}(h,p,m,y).map(t=>{const e=[].concat(...t.map(t=>{var e=r(t,3);e[0];let n=e[1],o=e[2];return n<o?h[t[0]].slice(n,o+1):h[t[0]].slice(o,n+1).reverse()}));return{lineString:e,candidate:t,segments:t.length,length:o.geo.length(e)}});return g.sort((t,e)=>t.length-e.length||t.segments-e.segments||t.lineString.length-e.lineString.length),g[0].lineString.map(l)}},function(t,e,n){"use strict";t.exports.REV_RAILROAD=1,t.exports.REV_STATION=4},function(t,e,n){"use strict";const r=n(0),o=n(1),i=n(2);t.exports=function(t){t.prototype.eventSearchInput=function(t){const e=t.target.value.trim();if(""===e)return r(".search-result").empty(),void(this.state=o.IDLE);this.state=o.SELECTING_RAILROAD,this.displayRailroadResults(e)},t.prototype.eventRailroadMouseEnter=function(t){const e=r(t.target),n=e.data("type"),o=parseInt(e.data("hash"));let i;"line"===n?i=this.JRP.getRailroadFeatures(o):"series"===n&&(i=this.JRP.getSeriesFeatures(o)),this.setPreviewRailroads(i)},t.prototype.eventRailroadMouseLeave=function(t){this.unsetPreviewRailroads()},t.prototype.eventRailroadClick=function(t){const e=r(t.target).closest(".search-item"),n=e.data("type"),i=parseInt(e.data("hash"));this.promotePreviewRailroadsToState(),this.state=o.SELECTING_START,this.stateRailroadType=n,this.stateRailroadHash=i,this.enableSearchState(e.find(".name-primary").text()),this.displayStationResults(n,i)},t.prototype.displayRailroadResults=function(t){r(".search-result").empty(),this.JRP.searchRailroads(t).forEach(t=>{let e;"line"===t.type?(e=i.searchItem(t.line,t.company)).data("hash",t.hash):"series"===t.type&&(e=i.searchItem(t.name,t.seriesType)).data("hash",t.hash),e.data("type",t.type),r(".search-result").append(e)}),r(".search-result .search-item").on("mouseenter",this.eventRailroadMouseEnter.bind(this)).on("mouseleave",this.eventRailroadMouseLeave.bind(this)).on("click",this.eventRailroadClick.bind(this))},t.prototype.setPreviewRailroads=function(t){this.unsetPreviewRailroads(),this.previewRailroads=t,this.previewPolylines=this.previewRailroads.map(t=>this.newGooglePolyline(t.geometry.coordinates,"#ff0000",1))},t.prototype.unsetPreviewRailroads=function(){if(delete this.previewRailroads,this.previewPolylines){for(let t=0,e=this.previewPolylines.length;t<e;t++)this.previewPolylines[t].setMap(null),delete this.previewPolylines[t];this.previewPolylines=[]}},t.prototype.promotePreviewRailroadsToState=function(){this.stateRailroads=this.previewRailroads,this.statePolylines=this.previewPolylines,this.previewRailroads=[],this.previewPolylines=[]},t.prototype.unsetStateRailroads=function(){if(delete this.stateRailroads,delete this.stateRailroadType,delete this.stateRailroadHash,this.statePolylines){for(let t=0,e=this.statePolylines.length;t<e;t++)this.statePolylines[t].setMap(null),delete this.statePolylines[t];this.statePolylines=[]}}}},function(t,e,n){"use strict";const r=n(0),o=n(1),i=n(2);t.exports=function(t){t.prototype.eventStationMouseEnter=function(t){const e=r(t.target),n=parseInt(e.data("hash")),o=this.JRP.getStationFeature(n);this.setSearchStateStation(e.find(".name-primary").text()),this.setPreviewStation(o)},t.prototype.eventStationMouseLeave=function(t){this.unsetPreviewStation()},t.prototype.eventStationClick=function(t){const e=r(t.target).closest(".search-item"),n=parseInt(e.data("hash"));if(this.promotePreviewStationsToState(),this.state===o.SELECTING_START)this.state=o.SELECTING_END,this.stateStationStartHash=n;else if(this.state===o.SELECTING_END){const t=this.stateRailroadType,e=this.stateRailroadHash,r=this.stateStationStartHash,o=n;this.addPlotItem(t,e,r,o),this.resetSearchState()}},t.prototype.displayStationResults=function(t,e){r(".search-result").empty();let n=[];"line"===t?n=this.JRP.getStationsFromLine(e):"series"===t&&(n=this.JRP.getStationsFromSeries(e)),n.forEach(t=>{const e=i.searchItem(t.name,t.id);e.data("hash",t.hash),r(".search-result").append(e)}),r(".search-result .search-item").on("mouseenter",this.eventStationMouseEnter.bind(this)).on("mouseleave",this.eventStationMouseLeave.bind(this)).on("click",this.eventStationClick.bind(this))},t.prototype.setPreviewStation=function(t){if(this.unsetPreviewStation(),this.state===o.SELECTING_START){this.previewStationStart=t;const e=this.newGoogleMarker(t.geometry.coordinates,"始");this.previewMarkerStart=e}else if(this.state===o.SELECTING_END){this.previewStationEnd=t;const e=this.newGoogleMarker(t.geometry.coordinates,"終");this.previewMarkerEnd=e}},t.prototype.unsetPreviewStation=function(){this.state===o.SELECTING_START?(delete this.previewStationStart,this.previewMarkerStart&&this.previewMarkerStart.setMap(null),delete this.previewMarkerStart):this.state===o.SELECTING_END&&(delete this.previewStationEnd,this.previewMarkerEnd&&this.previewMarkerEnd.setMap(null),delete this.previewMarkerEnd)},t.prototype.unsetPreviewStations=function(){delete this.previewStationStart,delete this.previewStationEnd,this.previewMarkerStart&&this.previewMarkerStart.setMap(null),this.previewMarkerEnd&&this.previewMarkerEnd.setMap(null),delete this.previewMarkerStart,delete this.previewMarkerEnd},t.prototype.promotePreviewStationsToState=function(){this.state===o.SELECTING_START?(this.stateStationStart=this.previewStationStart,this.stateMarkerStart=this.previewMarkerStart,delete this.previewStationStart,delete this.previewMarkerStart):this.state===o.SELECTING_END&&(this.stateStationEnd=this.previewStationEnd,this.stateMarkerEnd=this.previewMarkerEnd,delete this.previewStationEnd,delete this.previewMarkerEnd)},t.prototype.unsetStateStations=function(){delete this.stateStationStart,delete this.stateStationStartHash,delete this.stateStationEnd,delete this.stateStationEndHash,this.stateMarkerStart&&this.stateMarkerStart.setMap(null),this.stateMarkerEnd&&this.stateMarkerEnd.setMap(null),delete this.stateMarkerStart,delete this.stateMarkerEnd}}},function(t,e,n){"use strict";const r=n(0),o=n(2);t.exports=function(t){t.prototype.eventPlotDelete=function(t){const e=r(t.target).closest(".plot-item"),n=parseInt(e.data("index"),10);this.deletePlotItem(n)},t.prototype.eventPlotChangeColor=function(t){const e=r(t.target).closest(".plot-item"),n=parseInt(e.data("index"),10),o=prompt("새로운 색상 (#rrggbb 형태)").trim();o&&(/^#[0-9a-f]{6}$/i.test(o)?this.changePlotColor(n,o):/^[0-9a-f]{6}$/i.test(o)&&this.changePlotColor(n,"#"+o))},t.prototype.eventPlotChangeWidth=function(t){const e=r(t.target).closest(".plot-item"),n=parseInt(e.data("index"),10),o=parseInt(prompt("새로운 너비 (숫자)").trim());o&&(Number.isNaN(o)||o<0||o>65535||this.changePlotWidth(n,o))},t.prototype.getPlotItem=function(t){return r(`.plot-list .plot-item[data-index='${t}']`)},t.prototype.addPlotItem=function(t,e,n,i,s="#000000",a=1){const c=this.JRP.getRoute(t,e,n,i);if(!1===c)return void alert("Unable to find a route");let l;if("line"===t){l=this.JRP.getRailroadFeatures(e)[0].properties.lineName}else if("series"===t){l=this.JRP.seriesHashes.get(e).name}const u=this.JRP.getStationFeature(n).properties.stationName,h=this.JRP.getStationFeature(i).properties.stationName,p=this.plots.length,d={lineString:c,properties:{type:t,lineName:l,lineHash:e,startName:u,startHash:n,endName:h,endHash:i,color:s,width:a},polyline:this.newGooglePolyline(c,s,a)};this.plots.push(d);const f=o.plotItem(l,`${u} → ${h}`,s,a);return f.data("index",p),f.find(".action-delete").on("click",this.eventPlotDelete.bind(this)),f.find(".action-color").on("click",this.eventPlotChangeColor.bind(this)),f.find(".action-width").on("click",this.eventPlotChangeWidth.bind(this)),r(".plot-list").append(f),p},t.prototype.deletePlotItem=function(t){this.getPlotItem(t).remove();for(let e=t+1;e<this.plots.length;e++)this.getPlotItem(e).data("index",e-1);this.plots[t].polyline.setMap(null),this.plots.splice(t,1)},t.prototype.changePlotColor=function(t,e){this.plots[t].polyline.set("strokeColor",e),this.plots[t].properties.color=e,this.getPlotItem(t).find(".action-color var").text(e)},t.prototype.changePlotWidth=function(t,e){this.plots[t].polyline.set("strokeWeight",e),this.plots[t].properties.width=e,this.getPlotItem(t).find(".action-width var").text(e)}}},function(t,e,n){"use strict";const r=n(0),o=n(5),i=n(16),s=n(19);t.exports=function(t){t.prototype.showModalImportJrp=function(){r(".modal-import-jrp").addClass("active");const t=r(".modal-import-jrp textarea").first();t.value="",t.focus()},t.prototype.eventModalImportJrp=function(t){const e=r(".modal-import-jrp textarea").first().value.trim();if(""===e)return;let n;try{if(!(n=e.startsWith("JRP2-")?this.JRP.decodeJRP2(e,window.atob):this.JRP.decodeJRP1(e)))throw new Error}catch(t){return void alert("올바르지 않은 데이터입니다.")}n.forEach(t=>{const e=t.type,n=t.lineHash,r=t.startHash,o=t.endHash,i=t.color,s=t.width;this.addPlotItem(e,n,r,o,i,s)}),r(t.target).closest(".modal").removeClass("active")},t.prototype.showModalExportJrp=function(){const t=this.plots.map(t=>({type:t.properties.type,lineHash:t.properties.lineHash,startHash:t.properties.startHash,endHash:t.properties.endHash,color:t.properties.color,width:t.properties.width})),e=this.JRP.encodeJRP2(t,window.btoa);r(".modal-export-jrp").addClass("active");const n=r(".modal-export-jrp textarea").first();n.value=e,n.select()},t.prototype.showModalExportPolyline=function(){const t=[];this.plots.forEach(e=>{const n=e.properties,r=e.polyline.getPath();t.push(`${n.lineName} - ${n.startName} -> ${n.endName}`),t.push(google.maps.geometry.encoding.encodePath(r))});let e=t.join("\n");r(".modal-export-polyline [name=double-backslash]").first().checked&&(e=e.replace(/\\/g,"\\\\")),r(".modal-export-polyline").addClass("active");const n=r(".modal-export-polyline textarea").first();n.value=e,n.select()},t.prototype.showModalExportKml=function(){const t=new s;this.plots.forEach(e=>{const n=e.properties,r=`${n.startName} → ${n.endName}`,o=n.lineName,i=e.lineString;t.addLineString(r,o,i,n.color,n.width)});const e=t.build(),n=o().format("YYYY.MM.DD.HH.mm.ss"),r=new Blob([e],{type:s.MIME}),a=`Japan Railroad Plotter (${n}).kml`;i.saveAs(r,a)}}},function(t,e,n){var r,o=o||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=function(){return t.URL||t.webkitURL||t},n=t.document.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in n,o=/constructor/i.test(t.HTMLElement)||t.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},a=function(t){setTimeout(function(){"string"==typeof t?e().revokeObjectURL(t):t.remove()},4e4)},c=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},l=function(l,u,h){h||(l=c(l));var p,d=this,f="application/octet-stream"===l.type,m=function(){!function(t,e,n){for(var r=(e=[].concat(e)).length;r--;){var o=t["on"+e[r]];if("function"==typeof o)try{o.call(t,n||t)}catch(t){s(t)}}}(d,"writestart progress write writeend".split(" "))};if(d.readyState=d.INIT,r)return p=e().createObjectURL(l),void setTimeout(function(){n.href=p,n.download=u,function(t){var e=new MouseEvent("click");t.dispatchEvent(e)}(n),m(),a(p),d.readyState=d.DONE});!function(){if((i||f&&o)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var e=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,d.readyState=d.DONE,m()},n.readAsDataURL(l),void(d.readyState=d.INIT)}p||(p=e().createObjectURL(l)),f?t.location.href=p:t.open(p,"_blank")||(t.location.href=p);d.readyState=d.DONE,m(),a(p)}()},u=l.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=c(t)),navigator.msSaveOrOpenBlob(t,e)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(t,e,n){return new l(t,e||t.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */void 0!==t&&t.exports?t.exports.saveAs=o:null!==n(17)&&null!==n(18)&&(void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r))},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){"use strict";const r=n(5);t.exports=class{constructor(){this.styles={},this.placemarks=[]}addLineString(t,e,n,r,o){const i=r.substr(1),s=r.substr(5,2)+r.substr(3,2)+r.substr(1,2),a=`line-${i}-${o}`;this.styles[a]="<LineStyle>"+`<color>ff${s}</color>`+`<width>${o}</width>`+"</LineStyle>",this.placemarks.push("<Placemark>"+`<name>${t}</name>`+`<description><![CDATA[${e}]]></description>`+`<styleUrl>#${a}</styleUrl>`,"<LineString><tessellate>1</tessellate><coordinates>"+n.map(([t,e])=>`${t.toFixed(5)},${e.toFixed(5)},0`).join("\n")+"</coordinates></LineString></Placemark>")}build(){const t=[],e=r().format("YYYY-MM-DD HH:mm:ss");t.push('<?xml version="1.0" encoding="UTF-8"?>'),t.push('<kml xmlns="http://www.opengis.net/kml/2.2">'),t.push("<Document>"),t.push(`<name>Japan Railroad Plotter (${e})</name>`);for(const e in this.styles)t.push(`<Style id="${e}">${this.styles[e]}</Style>`);for(const e of this.placemarks)t.push(e);return t.push("</Document>"),t.push("</kml>"),t.join("\n")}},t.exports.MIME="application/vnd.google-earth.kml+xml; charset=utf-8"},function(t,e,n){},,function(t,e,n){"use strict";n.r(e);var r=function(t){return t},o=function(t){if(null==t)return r;var e,n,o=t.scale[0],i=t.scale[1],s=t.translate[0],a=t.translate[1];return function(t,r){r||(e=n=0);var c=2,l=t.length,u=new Array(l);for(u[0]=(e+=t[0])*o+s,u[1]=(n+=t[1])*i+a;c<l;)u[c]=t[c],++c;return u}},i=function(t){var e,n=o(t.transform),r=1/0,i=r,s=-r,a=-r;function c(t){(t=n(t))[0]<r&&(r=t[0]),t[0]>s&&(s=t[0]),t[1]<i&&(i=t[1]),t[1]>a&&(a=t[1])}function l(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(l);break;case"Point":c(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(c)}}for(e in t.arcs.forEach(function(t){for(var e,o=-1,c=t.length;++o<c;)(e=n(t[o],o))[0]<r&&(r=e[0]),e[0]>s&&(s=e[0]),e[1]<i&&(i=e[1]),e[1]>a&&(a=e[1])}),t.objects)l(t.objects[e]);return[r,i,s,a]},s=function(t,e){for(var n,r=t.length,o=r-e;o<--r;)n=t[o],t[o++]=t[r],t[r]=n},a=function(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return c(t,e)})}:c(t,e)};function c(t,e){var n=e.id,r=e.bbox,o=null==e.properties?{}:e.properties,i=l(t,e);return null==n&&null==r?{type:"Feature",properties:o,geometry:i}:null==r?{type:"Feature",id:n,properties:o,geometry:i}:{type:"Feature",id:n,bbox:r,properties:o,geometry:i}}function l(t,e){var n=o(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var o=r[t<0?~t:t],i=0,a=o.length;i<a;++i)e.push(n(o[i],i));t<0&&s(e,a)}function a(t){return n(t)}function c(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function l(t){for(var e=c(t);e.length<4;)e.push(e[0]);return e}function u(t){return t.map(l)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=c(e.arcs);break;case"MultiLineString":n=e.arcs.map(c);break;case"Polygon":n=u(e.arcs);break;case"MultiPolygon":n=e.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(e)}var u=function(t,e){var n={},r={},o={},i=[],s=-1;function a(t,e){for(var r in t){var o=t[r];delete e[o.start],delete o.start,delete o.end,o.forEach(function(t){n[t<0?~t:t]=1}),i.push(o)}}return e.forEach(function(n,r){var o,i=t.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(o=e[++s],e[s]=n,e[r]=o)}),e.forEach(function(e){var n,i,s=function(e){var n,r=t.arcs[e<0?~e:e],o=r[0];t.transform?(n=[0,0],r.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=r[r.length-1];return e<0?[n,o]:[o,n]}(e),a=s[0],c=s[1];if(n=o[a])if(delete o[n.end],n.push(e),n.end=c,i=r[c]){delete r[i.start];var l=i===n?n:n.concat(i);r[l.start=n.start]=o[l.end=i.end]=l}else r[n.start]=o[n.end]=n;else if(n=r[c])if(delete r[n.start],n.unshift(e),n.start=a,i=o[a]){delete o[i.end];var u=i===n?n:i.concat(n);r[u.start=i.start]=o[u.end=n.end]=u}else r[n.start]=o[n.end]=n;else r[(n=[e]).start=a]=o[n.end=c]=n}),a(o,r),a(r,o),e.forEach(function(t){n[t<0?~t:t]||i.push([t])}),i},h=function(t){return l(t,p.apply(this,arguments))};function p(t,e,n){var r,o,i;if(arguments.length>1)r=function(t,e,n){var r,o=[],i=[];function s(t){var e=t<0?~t:t;(i[e]||(i[e]=[])).push({i:t,g:r})}function a(t){t.forEach(s)}function c(t){t.forEach(a)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":a(e.arcs);break;case"MultiLineString":case"Polygon":c(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(c)}(e.arcs)}}(e),i.forEach(null==n?function(t){o.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&o.push(t[0].i)}),o}(0,e,n);else for(o=0,r=new Array(i=t.arcs.length);o<i;++o)r[o]=o;return{type:"MultiLineString",arcs:u(t,r)}}var d=function(t){return l(t,f.apply(this,arguments))};function f(t,e){var n={},r=[],o=[];function i(t){t.forEach(function(e){e.forEach(function(e){(n[e=e<0?~e:e]||(n[e]=[])).push(t)})}),r.push(t)}function s(e){return function(t){for(var e,n=-1,r=t.length,o=t[r-1],i=0;++n<r;)e=o,o=t[n],i+=e[0]*o[1]-e[1]*o[0];return Math.abs(i)}(l(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach(function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":i(e.arcs);break;case"MultiPolygon":e.arcs.forEach(i)}}),r.forEach(function(t){if(!t._){var e=[],r=[t];for(t._=1,o.push(e);t=r.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){n[t<0?~t:t].forEach(function(t){t._||(t._=1,r.push(t))})})})}}),r.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:o.map(function(e){var r,o=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){n[t<0?~t:t].length<2&&o.push(t)})})}),(r=(o=u(t,o)).length)>1)for(var i,a,c=1,l=s(o[0]);c<r;++c)(i=s(o[c]))>l&&(a=o[0],o[0]=o[c],o[c]=a,l=i);return o})}}var m=function(t,e){for(var n=0,r=t.length;n<r;){var o=n+r>>>1;t[o]<e?n=o+1:r=o}return n},y=function(t){var e={},n=t.map(function(){return[]});function r(t,n){t.forEach(function(t){t<0&&(t=~t);var r=e[t];r?r.push(n):e[t]=[n]})}function o(t,e){t.forEach(function(t){r(t,e)})}var i={LineString:r,MultiLineString:o,Polygon:o,MultiPolygon:function(t,e){t.forEach(function(t){o(t,e)})}};for(var s in t.forEach(function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach(function(e){t(e,n)}):e.type in i&&i[e.type](e.arcs,n)}),e)for(var a=e[s],c=a.length,l=0;l<c;++l)for(var u=l+1;u<c;++u){var h,p=a[l],d=a[u];(h=n[p])[s=m(h,d)]!==d&&h.splice(s,0,d),(h=n[d])[s=m(h,p)]!==p&&h.splice(s,0,p)}return n},g=function(t){if(null==t)return r;var e,n,o=t.scale[0],i=t.scale[1],s=t.translate[0],a=t.translate[1];return function(t,r){r||(e=n=0);var c=2,l=t.length,u=new Array(l),h=Math.round((t[0]-s)/o),p=Math.round((t[1]-a)/i);for(u[0]=h-e,e=h,u[1]=p-n,n=p;c<l;)u[c]=t[c],++c;return u}},v=function(t,e){if(t.transform)throw new Error("already quantized");if(e&&e.scale)c=t.bbox;else{if(!((n=Math.floor(e))>=2))throw new Error("n must be ≥2");var n,r=(c=t.bbox||i(t))[0],o=c[1],s=c[2],a=c[3];e={scale:[s-r?(s-r)/(n-1):1,a-o?(a-o)/(n-1):1],translate:[r,o]}}var c,l,u=g(e),h=t.objects,p={};function d(t){return u(t)}function f(t){var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(f)};break;case"Point":e={type:"Point",coordinates:d(t.coordinates)};break;case"MultiPoint":e={type:"MultiPoint",coordinates:t.coordinates.map(d)};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}for(l in h)p[l]=f(h[l]);return{type:"Topology",bbox:c,transform:e,objects:p,arcs:t.arcs.map(function(t){var e,n=0,r=1,o=t.length,i=new Array(o);for(i[0]=u(t[0],0);++n<o;)((e=u(t[n],n))[0]||e[1])&&(i[r++]=e);return 1===r&&(i[r++]=[0,0]),i.length=r,i})}};n.d(e,"bbox",function(){return i}),n.d(e,"feature",function(){return a}),n.d(e,"mesh",function(){return h}),n.d(e,"meshArcs",function(){return p}),n.d(e,"merge",function(){return d}),n.d(e,"mergeArcs",function(){return f}),n.d(e,"neighbors",function(){return y}),n.d(e,"quantize",function(){return v}),n.d(e,"transform",function(){return o}),n.d(e,"untransform",function(){return g})}]);