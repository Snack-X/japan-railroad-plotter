!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,r){"use strict";r.r(e);var n=function(t){return t},o=function(t){if(null==t)return n;var e,r,o=t.scale[0],a=t.scale[1],i=t.translate[0],s=t.translate[1];return function(t,n){n||(e=r=0);var c=2,u=t.length,l=new Array(u);for(l[0]=(e+=t[0])*o+i,l[1]=(r+=t[1])*a+s;c<u;)l[c]=t[c],++c;return l}},a=function(t){var e,r=o(t.transform),n=1/0,a=n,i=-n,s=-n;function c(t){(t=r(t))[0]<n&&(n=t[0]),t[0]>i&&(i=t[0]),t[1]<a&&(a=t[1]),t[1]>s&&(s=t[1])}function u(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(u);break;case"Point":c(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(c)}}for(e in t.arcs.forEach(function(t){for(var e,o=-1,c=t.length;++o<c;)(e=r(t[o],o))[0]<n&&(n=e[0]),e[0]>i&&(i=e[0]),e[1]<a&&(a=e[1]),e[1]>s&&(s=e[1])}),t.objects)u(t.objects[e]);return[n,a,i,s]},i=function(t,e){for(var r,n=t.length,o=n-e;o<--n;)r=t[o],t[o++]=t[n],t[n]=r},s=function(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return c(t,e)})}:c(t,e)};function c(t,e){var r=e.id,n=e.bbox,o=null==e.properties?{}:e.properties,a=u(t,e);return null==r&&null==n?{type:"Feature",properties:o,geometry:a}:null==n?{type:"Feature",id:r,properties:o,geometry:a}:{type:"Feature",id:r,bbox:n,properties:o,geometry:a}}function u(t,e){var r=o(t.transform),n=t.arcs;function a(t,e){e.length&&e.pop();for(var o=n[t<0?~t:t],a=0,s=o.length;a<s;++a)e.push(r(o[a],a));t<0&&i(e,s)}function s(t){return r(t)}function c(t){for(var e=[],r=0,n=t.length;r<n;++r)a(t[r],e);return e.length<2&&e.push(e[0]),e}function u(t){for(var e=c(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(u)}return function t(e){var r,n=e.type;switch(n){case"GeometryCollection":return{type:n,geometries:e.geometries.map(t)};case"Point":r=s(e.coordinates);break;case"MultiPoint":r=e.coordinates.map(s);break;case"LineString":r=c(e.arcs);break;case"MultiLineString":r=e.arcs.map(c);break;case"Polygon":r=l(e.arcs);break;case"MultiPolygon":r=e.arcs.map(l);break;default:return null}return{type:n,coordinates:r}}(e)}var l=function(t,e){var r={},n={},o={},a=[],i=-1;function s(t,e){for(var n in t){var o=t[n];delete e[o.start],delete o.start,delete o.end,o.forEach(function(t){r[t<0?~t:t]=1}),a.push(o)}}return e.forEach(function(r,n){var o,a=t.arcs[r<0?~r:r];a.length<3&&!a[1][0]&&!a[1][1]&&(o=e[++i],e[i]=r,e[n]=o)}),e.forEach(function(e){var r,a,i=function(e){var r,n=t.arcs[e<0?~e:e],o=n[0];t.transform?(r=[0,0],n.forEach(function(t){r[0]+=t[0],r[1]+=t[1]})):r=n[n.length-1];return e<0?[r,o]:[o,r]}(e),s=i[0],c=i[1];if(r=o[s])if(delete o[r.end],r.push(e),r.end=c,a=n[c]){delete n[a.start];var u=a===r?r:r.concat(a);n[u.start=r.start]=o[u.end=a.end]=u}else n[r.start]=o[r.end]=r;else if(r=n[c])if(delete n[r.start],r.unshift(e),r.start=s,a=o[s]){delete o[a.end];var l=a===r?r:a.concat(r);n[l.start=a.start]=o[l.end=r.end]=l}else n[r.start]=o[r.end]=r;else n[(r=[e]).start=s]=o[r.end=c]=r}),s(o,n),s(n,o),e.forEach(function(t){r[t<0?~t:t]||a.push([t])}),a},f=function(t){return u(t,p.apply(this,arguments))};function p(t,e,r){var n,o,a;if(arguments.length>1)n=function(t,e,r){var n,o=[],a=[];function i(t){var e=t<0?~t:t;(a[e]||(a[e]=[])).push({i:t,g:n})}function s(t){t.forEach(i)}function c(t){t.forEach(s)}return function t(e){switch(n=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":c(e.arcs);break;case"MultiPolygon":e.arcs.forEach(c)}}(e),a.forEach(null==r?function(t){o.push(t[0].i)}:function(t){r(t[0].g,t[t.length-1].g)&&o.push(t[0].i)}),o}(0,e,r);else for(o=0,n=new Array(a=t.arcs.length);o<a;++o)n[o]=o;return{type:"MultiLineString",arcs:l(t,n)}}var h=function(t){return u(t,d.apply(this,arguments))};function d(t,e){var r={},n=[],o=[];function a(t){t.forEach(function(e){e.forEach(function(e){(r[e=e<0?~e:e]||(r[e]=[])).push(t)})}),n.push(t)}function i(e){return function(t){for(var e,r=-1,n=t.length,o=t[n-1],a=0;++r<n;)e=o,o=t[r],a+=e[0]*o[1]-e[1]*o[0];return Math.abs(a)}(u(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach(function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":a(e.arcs);break;case"MultiPolygon":e.arcs.forEach(a)}}),n.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,o.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){r[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),n.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:o.map(function(e){var n,o=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){r[t<0?~t:t].length<2&&o.push(t)})})}),(n=(o=l(t,o)).length)>1)for(var a,s,c=1,u=i(o[0]);c<n;++c)(a=i(o[c]))>u&&(s=o[0],o[0]=o[c],o[c]=s,u=a);return o})}}var g=function(t,e){for(var r=0,n=t.length;r<n;){var o=r+n>>>1;t[o]<e?r=o+1:n=o}return r},m=function(t){var e={},r=t.map(function(){return[]});function n(t,r){t.forEach(function(t){t<0&&(t=~t);var n=e[t];n?n.push(r):e[t]=[r]})}function o(t,e){t.forEach(function(t){n(t,e)})}var a={LineString:n,MultiLineString:o,Polygon:o,MultiPolygon:function(t,e){t.forEach(function(t){o(t,e)})}};for(var i in t.forEach(function t(e,r){"GeometryCollection"===e.type?e.geometries.forEach(function(e){t(e,r)}):e.type in a&&a[e.type](e.arcs,r)}),e)for(var s=e[i],c=s.length,u=0;u<c;++u)for(var l=u+1;l<c;++l){var f,p=s[u],h=s[l];(f=r[p])[i=g(f,h)]!==h&&f.splice(i,0,h),(f=r[h])[i=g(f,p)]!==p&&f.splice(i,0,p)}return r},y=function(t){if(null==t)return n;var e,r,o=t.scale[0],a=t.scale[1],i=t.translate[0],s=t.translate[1];return function(t,n){n||(e=r=0);var c=2,u=t.length,l=new Array(u),f=Math.round((t[0]-i)/o),p=Math.round((t[1]-s)/a);for(l[0]=f-e,e=f,l[1]=p-r,r=p;c<u;)l[c]=t[c],++c;return l}},v=function(t,e){if(t.transform)throw new Error("already quantized");if(e&&e.scale)c=t.bbox;else{if(!((r=Math.floor(e))>=2))throw new Error("n must be ≥2");var r,n=(c=t.bbox||a(t))[0],o=c[1],i=c[2],s=c[3];e={scale:[i-n?(i-n)/(r-1):1,s-o?(s-o)/(r-1):1],translate:[n,o]}}var c,u,l=y(e),f=t.objects,p={};function h(t){return l(t)}function d(t){var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(d)};break;case"Point":e={type:"Point",coordinates:h(t.coordinates)};break;case"MultiPoint":e={type:"MultiPoint",coordinates:t.coordinates.map(h)};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}for(u in f)p[u]=d(f[u]);return{type:"Topology",bbox:c,transform:e,objects:p,arcs:t.arcs.map(function(t){var e,r=0,n=1,o=t.length,a=new Array(o);for(a[0]=l(t[0],0);++r<o;)((e=l(t[r],r))[0]||e[1])&&(a[n++]=e);return 1===n&&(a[n++]=[0,0]),a.length=n,a})}},b=function(t,e,r,n,o,a){3===arguments.length&&(n=a=Array,o=null);for(var i=new n(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=new a(t),c=t-1,u=0;u<t;++u)i[u]=o;return{set:function(n,a){for(var u=e(n)&c,l=i[u],f=0;l!=o;){if(r(l,n))return s[u]=a;if(++f>=t)throw new Error("full hashmap");l=i[u=u+1&c]}return i[u]=n,s[u]=a,a},maybeSet:function(n,a){for(var u=e(n)&c,l=i[u],f=0;l!=o;){if(r(l,n))return s[u];if(++f>=t)throw new Error("full hashmap");l=i[u=u+1&c]}return i[u]=n,s[u]=a,a},get:function(n,a){for(var u=e(n)&c,l=i[u],f=0;l!=o;){if(r(l,n))return s[u];if(++f>=t)break;l=i[u=u+1&c]}return a},keys:function(){for(var t=[],e=0,r=i.length;e<r;++e){var n=i[e];n!=o&&t.push(n)}return t}}},P=function(t,e){return t[0]===e[0]&&t[1]===e[1]},M=new ArrayBuffer(16),x=new Float64Array(M),w=new Uint32Array(M),E=function(t){x[0]=t[0],x[1]=t[1];var e=w[0]^w[1];return 2147483647&(e=e<<5^e>>7^w[2]^w[3])},k=function(t){var e,r,n,o,a=t.coordinates,i=t.lines,s=t.rings,c=function(){for(var t=b(1.4*a.length,w,k,Int32Array,-1,Int32Array),e=new Int32Array(a.length),r=0,n=a.length;r<n;++r)e[r]=t.maybeSet(r,r);return e}(),u=new Int32Array(a.length),l=new Int32Array(a.length),f=new Int32Array(a.length),p=new Int8Array(a.length),h=0;for(e=0,r=a.length;e<r;++e)u[e]=l[e]=f[e]=-1;for(e=0,r=i.length;e<r;++e){var d=i[e],g=d[0],m=d[1];for(n=c[g],o=c[++g],++h,p[n]=1;++g<=m;)x(e,n,n=o,o=c[g]);++h,p[o]=1}for(e=0,r=a.length;e<r;++e)u[e]=-1;for(e=0,r=s.length;e<r;++e){var y=s[e],v=y[0]+1,M=y[1];for(x(e,c[M-1],n=c[v-1],o=c[v]);++v<=M;)x(e,n,n=o,o=c[v])}function x(t,e,r,n){if(u[r]!==t){u[r]=t;var o=l[r];if(o>=0){var a=f[r];o===e&&a===n||o===n&&a===e||(++h,p[r]=1)}else l[r]=e,f[r]=n}}function w(t){return E(a[t])}function k(t,e){return P(a[t],a[e])}u=l=f=null;var R,J=function(t,e,r,n,o){3===arguments.length&&(n=Array,o=null);for(var a=new n(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),i=t-1,s=0;s<t;++s)a[s]=o;return{add:function(n){for(var s=e(n)&i,c=a[s],u=0;c!=o;){if(r(c,n))return!0;if(++u>=t)throw new Error("full hashset");c=a[s=s+1&i]}return a[s]=n,!0},has:function(n){for(var s=e(n)&i,c=a[s],u=0;c!=o;){if(r(c,n))return!0;if(++u>=t)break;c=a[s=s+1&i]}return!1},values:function(){for(var t=[],e=0,r=a.length;e<r;++e){var n=a[e];n!=o&&t.push(n)}return t}}}(1.4*h,E,P);for(e=0,r=a.length;e<r;++e)p[R=c[e]]&&J.add(a[R]);return J};function R(t,e,r){for(var n,o=e+(r---e>>1);e<o;++e,--r)n=t[e],t[e]=t[r],t[r]=n}function J(t){var e,r=$(t.geometry);for(e in null!=t.id&&(r.id=t.id),null!=t.bbox&&(r.bbox=t.bbox),t.properties){r.properties=t.properties;break}return r}function $(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map($)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}var A=function(t,e){var r=function(t){var e=1/0,r=1/0,n=-1/0,o=-1/0;function a(t){null!=t&&i.hasOwnProperty(t.type)&&i[t.type](t)}var i={GeometryCollection:function(t){t.geometries.forEach(a)},Point:function(t){s(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(s)},LineString:function(t){c(t.arcs)},MultiLineString:function(t){t.arcs.forEach(c)},Polygon:function(t){t.arcs.forEach(c)},MultiPolygon:function(t){t.arcs.forEach(u)}};function s(t){var a=t[0],i=t[1];a<e&&(e=a),a>n&&(n=a),i<r&&(r=i),i>o&&(o=i)}function c(t){t.forEach(s)}function u(t){t.forEach(c)}for(var l in t)a(t[l]);return n>=e&&o>=r?[e,r,n,o]:void 0}(t=function(t){var e,r,n={};for(e in t)n[e]=null==(r=t[e])?{type:null}:("FeatureCollection"===r.type?function(t){var e={type:"GeometryCollection",geometries:t.features.map(J)};return null!=t.bbox&&(e.bbox=t.bbox),e}:"Feature"===r.type?J:$)(r);return n}(t)),n=e>0&&r&&function(t,e,r){var n=e[0],o=e[1],a=e[2],i=e[3],s=a-n?(r-1)/(a-n):1,c=i-o?(r-1)/(i-o):1;function u(t){return[Math.round((t[0]-n)*s),Math.round((t[1]-o)*c)]}function l(t,e){for(var r,a,i,u,l,f=-1,p=0,h=t.length,d=new Array(h);++f<h;)r=t[f],u=Math.round((r[0]-n)*s),l=Math.round((r[1]-o)*c),u===a&&l===i||(d[p++]=[a=u,i=l]);for(d.length=p;p<e;)p=d.push([d[0][0],d[0][1]]);return d}function f(t){return l(t,2)}function p(t){return l(t,4)}function h(t){return t.map(p)}function d(t){null!=t&&g.hasOwnProperty(t.type)&&g[t.type](t)}var g={GeometryCollection:function(t){t.geometries.forEach(d)},Point:function(t){t.coordinates=u(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(u)},LineString:function(t){t.arcs=f(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(f)},Polygon:function(t){t.arcs=h(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(h)}};for(var m in t)d(t[m]);return{scale:[1/s,1/c],translate:[n,o]}}(t,r,e),o=function(t){var e,r,n,o,a=t.coordinates,i=t.lines,s=t.rings,c=i.length+s.length;for(delete t.lines,delete t.rings,n=0,o=i.length;n<o;++n)for(e=i[n];e=e.next;)++c;for(n=0,o=s.length;n<o;++n)for(r=s[n];r=r.next;)++c;var u=b(2*c*1.4,E,P),l=t.arcs=[];for(n=0,o=i.length;n<o;++n){e=i[n];do{f(e)}while(e=e.next)}for(n=0,o=s.length;n<o;++n)if((r=s[n]).next)do{f(r)}while(r=r.next);else p(r);function f(t){var e,r,n,o,i,s,c,f;if(n=u.get(e=a[t[0]]))for(c=0,f=n.length;c<f;++c)if(h(o=n[c],t))return t[0]=o[0],void(t[1]=o[1]);if(i=u.get(r=a[t[1]]))for(c=0,f=i.length;c<f;++c)if(d(s=i[c],t))return t[1]=s[0],void(t[0]=s[1]);n?n.push(t):u.set(e,[t]),i?i.push(t):u.set(r,[t]),l.push(t)}function p(t){var e,r,n,o,i;if(r=u.get(a[t[0]]))for(o=0,i=r.length;o<i;++o){if(g(n=r[o],t))return t[0]=n[0],void(t[1]=n[1]);if(m(n,t))return t[0]=n[1],void(t[1]=n[0])}if(r=u.get(e=a[t[0]+y(t)]))for(o=0,i=r.length;o<i;++o){if(g(n=r[o],t))return t[0]=n[0],void(t[1]=n[1]);if(m(n,t))return t[0]=n[1],void(t[1]=n[0])}r?r.push(t):u.set(e,[t]),l.push(t)}function h(t,e){var r=t[0],n=e[0],o=t[1];if(r-o!=n-e[1])return!1;for(;r<=o;++r,++n)if(!P(a[r],a[n]))return!1;return!0}function d(t,e){var r=t[0],n=e[0],o=t[1],i=e[1];if(r-o!=n-i)return!1;for(;r<=o;++r,--i)if(!P(a[r],a[i]))return!1;return!0}function g(t,e){var r=t[0],n=e[0],o=t[1]-r;if(o!==e[1]-n)return!1;for(var i=y(t),s=y(e),c=0;c<o;++c)if(!P(a[r+(c+i)%o],a[n+(c+s)%o]))return!1;return!0}function m(t,e){var r=t[0],n=e[0],o=t[1],i=e[1],s=o-r;if(s!==i-n)return!1;for(var c=y(t),u=s-y(e),l=0;l<s;++l)if(!P(a[r+(l+c)%s],a[i-(l+u)%s]))return!1;return!0}function y(t){for(var e=t[0],r=t[1],n=e,o=n,i=a[n];++n<r;){var s=a[n];(s[0]<i[0]||s[0]===i[0]&&s[1]<i[1])&&(o=n,i=s)}return o-e}return t}(function(t){var e,r,n,o=k(t),a=t.coordinates,i=t.lines,s=t.rings;for(r=0,n=i.length;r<n;++r)for(var c=i[r],u=c[0],l=c[1];++u<l;)o.has(a[u])&&(e={0:u,1:c[1]},c[1]=u,c=c.next=e);for(r=0,n=s.length;r<n;++r)for(var f=s[r],p=f[0],h=p,d=f[1],g=o.has(a[p]);++h<d;)o.has(a[h])&&(g?(e={0:h,1:f[1]},f[1]=h,f=f.next=e):(m=a,y=p,v=d,b=d-h,R(m,y,v),R(m,y,y+b),R(m,y+b,v),a[d]=a[p],g=!0,h=p));var m,y,v,b;return t}(function(t){var e=-1,r=[],n=[],o=[];function a(t){t&&i.hasOwnProperty(t.type)&&i[t.type](t)}var i={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=s(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(s)},Polygon:function(t){t.arcs=t.arcs.map(c)},MultiPolygon:function(t){t.arcs=t.arcs.map(u)}};function s(t){for(var n=0,a=t.length;n<a;++n)o[++e]=t[n];var i={0:e-a+1,1:e};return r.push(i),i}function c(t){for(var r=0,a=t.length;r<a;++r)o[++e]=t[r];var i={0:e-a+1,1:e};return n.push(i),i}function u(t){return t.map(c)}for(var l in t)a(t[l]);return{type:"Topology",coordinates:o,lines:r,rings:n,objects:t}}(t))),a=o.coordinates,i=b(1.4*o.arcs.length,C,j);function s(t){t&&c.hasOwnProperty(t.type)&&c[t.type](t)}t=o.objects,o.bbox=r,o.arcs=o.arcs.map(function(t,e){return i.set(t,e),a.slice(t[0],t[1]+1)}),delete o.coordinates,a=null;var c={GeometryCollection:function(t){t.geometries.forEach(s)},LineString:function(t){t.arcs=u(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(u)},Polygon:function(t){t.arcs=t.arcs.map(u)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};function u(t){var e=[];do{var r=i.get(t);e.push(t[0]<t[1]?r:~r)}while(t=t.next);return e}function l(t){return t.map(u)}for(var f in t)s(t[f]);return n&&(o.transform=n,o.arcs=function(t){for(var e=-1,r=t.length;++e<r;){for(var n,o,a=t[e],i=0,s=1,c=a.length,u=a[0],l=u[0],f=u[1];++i<c;)n=(u=a[i])[0],o=u[1],n===l&&o===f||(a[s++]=[n-l,o-f],l=n,f=o);1===s&&(a[s++]=[0,0]),a.length=s}return t}(o.arcs)),o};function C(t){var e,r=t[0],n=t[1];return n<r&&(e=r,r=n,n=e),r+31*n}function j(t,e){var r,n=t[0],o=t[1],a=e[0],i=e[1];return o<n&&(r=n,n=o,o=r),i<a&&(r=a,a=i,i=r),n===a&&o===i}var L=function(t,e){var r,n=t.objects,o={};function a(t){var e,r;switch(t.type){case"Polygon":e=(r=i(t.arcs))?{type:"Polygon",arcs:r}:{type:null};break;case"MultiPolygon":e=(r=t.arcs.map(i).filter(N)).length?{type:"MultiPolygon",arcs:r}:{type:null};break;case"GeometryCollection":e=(r=t.geometries.map(a).filter(O)).length?{type:"GeometryCollection",geometries:r}:{type:null};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}function i(t){return t.length&&(r=t[0],e(r,!1))?[t[0]].concat(t.slice(1).filter(s)):null;var r}function s(t){return e(t,!0)}for(r in null==e&&(e=S),n)o[r]=a(n[r]);return function(t){var e,r,n=t.objects,o={},a=t.arcs,i=a.length,s=-1,c=new Array(i),u=0,l=-1;function f(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(f);break;case"LineString":h(t.arcs);break;case"MultiLineString":case"Polygon":t.arcs.forEach(h);break;case"MultiPolygon":t.arcs.forEach(d)}}function p(t){t<0&&(t=~t),c[t]||(c[t]=1,++u)}function h(t){t.forEach(p)}function d(t){t.forEach(h)}function g(t){var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(g)};break;case"LineString":e={type:"LineString",arcs:y(t.arcs)};break;case"MultiLineString":e={type:"MultiLineString",arcs:t.arcs.map(y)};break;case"Polygon":e={type:"Polygon",arcs:t.arcs.map(y)};break;case"MultiPolygon":e={type:"MultiPolygon",arcs:t.arcs.map(v)};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}function m(t){return t<0?~c[~t]:c[t]}function y(t){return t.map(m)}function v(t){return t.map(y)}for(r in n)f(n[r]);for(e=new Array(u);++s<i;)c[s]&&(c[s]=++l,e[l]=a[s]);for(r in n)o[r]=g(n[r]);return{type:"Topology",bbox:t.bbox,transform:t.transform,objects:o,arcs:e}}({type:"Topology",bbox:t.bbox,transform:t.transform,objects:o,arcs:t.arcs})};function S(){return!0}function N(t){return t}function O(t){return null!=t.type}var I=function(t){var e,r=new Array(t.arcs.length),n=0;function o(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(o);break;case"Polygon":a(t.arcs);break;case"MultiPolygon":t.arcs.forEach(a)}}function a(t){for(var e=0,o=t.length;e<o;++e,++n)for(var a=t[e],i=0,s=a.length;i<s;++i){var c=a[i];c<0&&(c=~c);var u=r[c];null==u?r[c]=n:u!==n&&(r[c]=-1)}}for(e in t.objects)o(t.objects[e]);return function(t){for(var e,n=0,o=t.length;n<o;++n)if(-1===r[(e=t[n])<0?~e:e])return!0;return!1}};function _(t){var e=t[0],r=t[1],n=t[2];return Math.abs((e[0]-n[0])*(r[1]-e[1])-(e[0]-r[0])*(n[1]-e[1]))/2}function T(t){for(var e,r=-1,n=t.length,o=t[n-1],a=0;++r<n;)e=o,o=t[r],a+=e[0]*o[1]-e[1]*o[0];return Math.abs(a)/2}var F=function(t,e,r){return e=null==e?Number.MIN_VALUE:+e,null==r&&(r=T),function(n,o){return r(s(t,{type:"Polygon",arcs:[n]}).geometry.coordinates[0],o)>=e}},G=function(t,e,r){var n=I(t),o=F(t,e,r);return function(t,e){return n(t,e)||o(t,e)}};function U(t,e){return t[1][2]-e[1][2]}function q(t){return[t[0],t[1],0]}var H=function(t,e){var r=t.transform?o(t.transform):q,n=function(){var t={},e=[],r=0;function n(t,r){for(;r>0;){var n=(r+1>>1)-1,o=e[n];if(U(t,o)>=0)break;e[o._=r]=o,e[t._=r=n]=t}}function o(t,n){for(;;){var o=n+1<<1,a=o-1,i=n,s=e[i];if(a<r&&U(e[a],s)<0&&(s=e[i=a]),o<r&&U(e[o],s)<0&&(s=e[i=o]),i===n)break;e[s._=n]=s,e[t._=n=i]=t}}return t.push=function(t){return n(e[t._=r]=t,r++),r},t.pop=function(){if(!(r<=0)){var t,n=e[0];return--r>0&&(t=e[r],o(e[t._=0]=t,0)),n}},t.remove=function(t){var a,i=t._;if(e[i]===t)return i!==--r&&(U(a=e[r],t)<0?n:o)(e[a._=i]=a,i),i},t}();null==e&&(e=_);var a=t.arcs.map(function(t){var o,a,s,c=[],u=0;for(a=1,s=(t=t.map(r)).length-1;a<s;++a)(o=[t[a-1],t[a],t[a+1]])[1][2]=e(o),c.push(o),n.push(o);for(t[0][2]=t[s][2]=1/0,a=0,s=c.length;a<s;++a)(o=c[a]).previous=c[a-1],o.next=c[a+1];for(;o=n.pop();){var l=o.previous,f=o.next;o[1][2]<u?o[1][2]=u:u=o[1][2],l&&(l.next=f,l[2]=o[2],i(l)),f&&(f.previous=l,f[0]=o[0],i(f))}return t});function i(t){n.remove(t),t[1][2]=e(t),n.push(t)}return{type:"Topology",bbox:t.bbox,objects:t.objects,arcs:a}},z=function(t,e){var r=[];return t.arcs.forEach(function(t){t.forEach(function(t){isFinite(t[2])&&r.push(t[2])})}),r.length&&function(t,e){if(!(r=t.length))return;if((e=+e)<=0||r<2)return t[0];if(e>=1)return t[r-1];var r,n=(r-1)*e,o=Math.floor(n),a=t[o],i=t[o+1];return a+(i-a)*(n-o)}(r.sort(B),e)};function B(t,e){return e-t}var V=function(t,e){e=null==e?Number.MIN_VALUE:+e;var r=t.arcs.map(function(t){for(var r,n=-1,o=0,a=t.length,i=new Array(a);++n<a;)(r=t[n])[2]>=e&&(i[o++]=[r[0],r[1]]);return i.length=o,i});return{type:"Topology",transform:t.transform,bbox:t.bbox,objects:t.objects,arcs:r}},D=Math.PI,W=2*D,X=D/4,Y=D/180,Z=Math.abs,K=Math.atan2,Q=Math.cos,tt=Math.sin;function et(t,e){for(var r,n,o,a=0,i=t.length,s=0,c=t[e?a++:i-1],u=c[0]*Y,l=c[1]*Y/2+X,f=Q(l),p=tt(l);a<i;++a){r=u,u=(c=t[a])[0]*Y,l=c[1]*Y/2+X,n=f,f=Q(l),o=p,p=tt(l);var h=u-r,d=h>=0?1:-1,g=d*h,m=o*p,y=n*f+m*Q(g),v=m*d*tt(g);s+=K(v,y)}return s}function rt(t,e){var r=et(t,!0);return e&&(r*=-1),2*(r<0?W+r:r)}function nt(t){return 2*Z(et(t,!1))}r.d(e,"bbox",function(){return a}),r.d(e,"feature",function(){return s}),r.d(e,"mesh",function(){return f}),r.d(e,"meshArcs",function(){return p}),r.d(e,"merge",function(){return h}),r.d(e,"mergeArcs",function(){return d}),r.d(e,"neighbors",function(){return m}),r.d(e,"quantize",function(){return v}),r.d(e,"transform",function(){return o}),r.d(e,"untransform",function(){return y}),r.d(e,"topology",function(){return A}),r.d(e,"filter",function(){return L}),r.d(e,"filterAttached",function(){return I}),r.d(e,"filterAttachedWeight",function(){return G}),r.d(e,"filterWeight",function(){return F}),r.d(e,"planarRingArea",function(){return T}),r.d(e,"planarTriangleArea",function(){return _}),r.d(e,"presimplify",function(){return H}),r.d(e,"quantile",function(){return z}),r.d(e,"simplify",function(){return V}),r.d(e,"sphericalRingArea",function(){return rt}),r.d(e,"sphericalTriangleArea",function(){return nt})},function(t,e,r){"use strict";function n(t,e,r,n){const o=(r-t)*Math.PI/180,a=(n-e)*Math.PI/180,i=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 6371e3*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))}t.exports={calculateLength:function(t){if(t.length<2)return 0;let e=0;for(let r=1;r<t.length;r++)e+=n(t[r-1][1],t[r-1][0],t[r][1],t[r][0]);return e},distance:n}},function(t,e,r){"use strict";var n=r(1);const o=n.calculateLength,a=(n.distance,-1),i=0,s=1,c=2;function u(t,e){return Math.round(1e5*t[0])===Math.round(1e5*e[0])&&Math.round(1e5*t[1])===Math.round(1e5*e[1])}t.exports=function(t,e,r){return log("line",t[0].properties.lineName,t[0].properties.company),log("lines.length",t.length),log("start",e.properties.stationName),log("end",r.properties.stationName),function(t,e,r){log(e,r);const n=[],l=[],f={};for(let e=0;e<t.length;e++){const r=n.length,o=t[e].geometry.coordinates.slice().map((t,e)=>[e,...t]);n.push(o),l.push([r,o[0]]),l.push([r,o[o.length-1]]),f[e]={},f[e][0]=null,f[e][o.length-1]=null}log("lines",n),log("endpoints",l);for(let t=0;t<n.length;t++)for(let e=0;e<l.length;e++){const r=[l[e][1][1],l[e][1][2]],o=n[t].filter(([t,n,o])=>l[e][1][0]!==t&&u([n,o],r))[0];o&&(log(`${t}[${o[0]}] - ${l[e][0]}[${l[e][1][0]}]`),f[t][o[0]]=[l[e][0],l[e][1][0]],f[l[e][0]][l[e][1][0]]=[t,o[0]])}log("intersections",f);const p=[],h=[];for(let t=0;t<n.length;t++){for(let o=0;o<n[t].length;o++){const a=n[t][o];if(u(e.geometry.coordinates,[a[1],a[2]])?(p[0]=t,p[1]=o):u(r.geometry.coordinates,[a[1],a[2]])&&(h[0]=t,h[1]=o),p.length&&h.length)break}if(p.length&&h.length)break}log("start end",p,h);const d=function t(e,r,n,o,i,u=[]){log("----------------------------------------------------------");const l=[];n[0]===o[0]&&(log("found direct"),l.push([[n[0],n[1],o[1]]]));const f=u.slice();f.push(`${n[0]}/${n[1]}`);let p,h=Object.keys(r[n[0]]).map(t=>parseInt(t));for(h.sort((t,e)=>t-e),p=0;p<h.length&&!(h[p]>=n[1]);p++);log("start",n),log("points, idx",h,p);const d=h[p]===n[1];if(log("at intersection",d),d&&i!==c){log("intersection",n[0],n[1]);const a=r[n[0]][n[1]];if(null===a||f.includes(`${a[0]}/${a[1]}`))log("intersection dead end");else{log("find route for",a,o);const n=t(e,r,a,o,c,f);log("intersection routes",n);for(let t=0;t<n.length;t++)l.push([...n[t]]);log("current routes",l)}}if(log("prev direction",i),i!==s)if(log("left idx",p-1),0===p)log("left dead end");else{const i=[n[0],h[p-1]];log("left",i),log("find route for",i,o);const s=t(e,r,i,o,a,f);log("left routes",s);for(let t=0;t<s.length;t++)l.push([[n[0],n[1],i[1]],...s[t]]);log("current routes",l)}if(i!==a)if(log("right idx",p),d&&p===h.length-1)log("right dead end");else{const a=[n[0],h[d?p+1:p]];log("right",a),log("find route for",a,o);const i=t(e,r,a,o,s,f);log("right routes",i);for(let t=0;t<i.length;t++)l.push([[n[0],n[1],a[1]],...i[t]]);log("current routes",l)}return log("final routes",l),l}(n,f,p,h,i,[]);if(0===d.length)return!1;const g=d.map(t=>[].concat(...t.map(([t,e,r])=>e<r?n[t].slice(e,r+1):n[t].slice(r,e+1).reverse())).map(([t,e,r])=>[e,r]));if(1===g.length)return g[0];const m=g.map(t=>[t,o(t)]);return m.sort((t,e)=>t[1]-e[1]),m[0][0]}(t,e,r)}},function(t,e,r){"use strict";window.$=document.querySelector.bind(document),window.$$=document.querySelectorAll.bind(document),[HTMLDocument,HTMLElement].forEach(t=>{t.prototype.$=t.prototype.querySelector,t.prototype.$$=t.prototype.querySelectorAll}),HTMLElement.prototype.$show=function(t="block"){this.style.display=t},HTMLElement.prototype.$hide=function(){this.style.display="none"},window._make=((t,e={})=>{const r=document.createElement(t);return Object.keys(e).forEach(t=>{r.setAttribute(t,e[t])}),r}),window.log=((...t)=>{console.log("["+(new Date).toLocaleString()+"]",...t)})},function(t,e,r){"use strict";t.exports.VERSION_RAILROAD=1,t.exports.VERSION_STATION=3},function(t,e,r){var n,o=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function o(t,e){if(!n[t]){n[t]={};for(var r=0;r<t.length;r++)n[t][t.charAt(r)]=r}return n[t][e]}var a={compressToBase64:function(t){if(null==t)return"";var r=a._compress(t,6,function(t){return e.charAt(t)});switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,function(r){return o(e,t.charAt(r))})},compressToUTF16:function(e){return null==e?"":a._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:a._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=a.compress(t),r=new Uint8Array(2*e.length),n=0,o=e.length;n<o;n++){var i=e.charCodeAt(n);r[2*n]=i>>>8,r[2*n+1]=i%256}return r},decompressFromUint8Array:function(e){if(null===e||void 0===e)return a.decompress(e);for(var r=new Array(e.length/2),n=0,o=r.length;n<o;n++)r[n]=256*e[2*n]+e[2*n+1];var i=[];return r.forEach(function(e){i.push(t(e))}),a.decompress(i.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":a._compress(t,6,function(t){return r.charAt(t)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,function(e){return o(r,t.charAt(e))}))},compress:function(e){return a._compress(e,16,function(e){return t(e)})},_compress:function(t,e,r){if(null==t)return"";var n,o,a,i={},s={},c="",u="",l="",f=2,p=3,h=2,d=[],g=0,m=0;for(a=0;a<t.length;a+=1)if(c=t.charAt(a),Object.prototype.hasOwnProperty.call(i,c)||(i[c]=p++,s[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(i,u))l=u;else{if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(n=0;n<h;n++)g<<=1,m==e-1?(m=0,d.push(r(g)),g=0):m++;for(o=l.charCodeAt(0),n=0;n<8;n++)g=g<<1|1&o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o>>=1}else{for(o=1,n=0;n<h;n++)g=g<<1|o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)g=g<<1|1&o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete s[l]}else for(o=i[l],n=0;n<h;n++)g=g<<1|1&o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o>>=1;0==--f&&(f=Math.pow(2,h),h++),i[u]=p++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(n=0;n<h;n++)g<<=1,m==e-1?(m=0,d.push(r(g)),g=0):m++;for(o=l.charCodeAt(0),n=0;n<8;n++)g=g<<1|1&o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o>>=1}else{for(o=1,n=0;n<h;n++)g=g<<1|o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)g=g<<1|1&o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete s[l]}else for(o=i[l],n=0;n<h;n++)g=g<<1|1&o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o>>=1;0==--f&&(f=Math.pow(2,h),h++)}for(o=2,n=0;n<h;n++)g=g<<1|1&o,m==e-1?(m=0,d.push(r(g)),g=0):m++,o>>=1;for(;;){if(g<<=1,m==e-1){d.push(r(g));break}m++}return d.join("")},decompress:function(t){return null==t?"":""==t?null:a._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,r,n){var o,a,i,s,c,u,l,f=[],p=4,h=4,d=3,g="",m=[],y={val:n(0),position:r,index:1};for(o=0;o<3;o+=1)f[o]=o;for(i=0,c=Math.pow(2,2),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),i|=(s>0?1:0)*u,u<<=1;switch(i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),i|=(s>0?1:0)*u,u<<=1;l=t(i);break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),i|=(s>0?1:0)*u,u<<=1;l=t(i);break;case 2:return""}for(f[3]=l,a=l,m.push(l);;){if(y.index>e)return"";for(i=0,c=Math.pow(2,d),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),i|=(s>0?1:0)*u,u<<=1;switch(l=i){case 0:for(i=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),i|=(s>0?1:0)*u,u<<=1;f[h++]=t(i),l=h-1,p--;break;case 1:for(i=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),i|=(s>0?1:0)*u,u<<=1;f[h++]=t(i),l=h-1,p--;break;case 2:return m.join("")}if(0==p&&(p=Math.pow(2,d),d++),f[l])g=f[l];else{if(l!==h)return null;g=a+a.charAt(0)}m.push(g),f[h++]=a+g.charAt(0),a=g,0==--p&&(p=Math.pow(2,d),d++)}}};return a}();void 0===(n=function(){return o}.call(e,r,e,t))||(t.exports=n)},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();const o=r(0),a=r(5);var i=r(4);const s=i.VERSION_RAILROAD,c=i.VERSION_STATION;r(3);const u=r(2);function l(){!function(){delete JRP.state.lineName,delete JRP.state.company,JRP.state.lineObjects.length&&(JRP.state.lineObjects.forEach(t=>t.setMap(null)),delete JRP.state.lineObjects);delete JRP.state.lineFeatures}(),delete JRP.state.startStation,delete JRP.state.startFeature,JRP.state.startObject&&(JRP.state.startObject.setMap(null),delete JRP.state.startObject),delete JRP.state.endStation,delete JRP.state.endFeature,JRP.state.endObject&&(JRP.state.endObject.setMap(null),delete JRP.state.endObject),function(){for(const t in JRP.tempPolylines)JRP.tempPolylines[t].forEach(t=>t.setMap(null)),delete JRP.tempPolylines[t];for(const t in JRP.tempMarkers)JRP.tempMarkers[t].setMap(null),delete JRP.tempMarkers[t]}()}function f(t,e){return JRP.railroads.features.filter(r=>r.properties.lineName===t&&r.properties.company===e)}function p(t){return JRP.stations.features.filter(e=>e.properties.groupId===t)[0]}function h(){return!JRP.state.startStation}function d(t,e){const r=_make("span",{class:"name-primary"});r.textContent=t;const n=_make("span",{class:"name-secondary"});n.textContent=e;const o=_make("li",{class:"item-item search-item"});return o.appendChild(r),o.appendChild(n),o}function g(t){$(".search-result").innerHTML="";const e=this.value.trim();""!==e&&function(t){const e=[],r={};return JRP.railroads.features.filter(e=>e.properties.lineName.includes(t)||e.properties.company.includes(t)).forEach(t=>{const n=t.properties.lineName+"ÿ"+t.properties.company;n in r||(r[n]=!0,e.push([t.properties.lineName,t.properties.company]))}),e}(e).forEach(([t,e])=>{const r=d(t,e);r.setAttribute("data-key",t+"ÿ"+e),r.addEventListener("mouseenter",m),r.addEventListener("mouseleave",y),r.addEventListener("click",v),$(".search-result").appendChild(r)})}function m(t){const e=this.getAttribute("data-key");var r=e.split("ÿ"),o=n(r,2);const a=o[0],i=o[1];if(JRP.tempPolylines[e])return;const s=[];f(a,i).forEach(t=>{const e=t.geometry.coordinates.map(([t,e])=>({lat:e,lng:t})),r=new google.maps.Polyline({path:e,strokeColor:"#FF0000",strokeWeight:1,map:JRP.map});s.push(r)}),JRP.tempPolylines[e]=s}function y(t){const e=this.getAttribute("data-key"),r=JRP.tempPolylines[e];if(r){for(let t=0;t<r.length;t++)r[t].setMap(null),delete r[t];delete JRP.tempPolylines[e]}}function v(t){var e=this.getAttribute("data-key").split("ÿ"),r=n(e,2);const o=r[0],a=r[1];!function(t,e){const r=t+"ÿ"+e;JRP.state.lineName=t,JRP.state.company=e,JRP.state.lineFeatures=f(t,e),JRP.state.lineObjects=JRP.tempPolylines[r],delete JRP.tempPolylines[r]}(o,a),$(".search-state").$show("table"),$(".state-current").textContent=o,$(".search-input input").removeEventListener("input",g),$(".search-input input").setAttribute("disabled","disabled"),$(".search-result").innerHTML="",function(t,e){const r=JRP.stations.features.filter(r=>r.properties.lineName===t&&r.properties.company===e);return r.sort((t,e)=>t.properties.groupId.localeCompare(e.properties.groupId)),r.map(t=>[t.properties.stationName,t.properties.groupId])}(o,a).forEach(([t,e])=>{const r=d(t,e);r.setAttribute("data-key",e),r.addEventListener("mouseenter",b),r.addEventListener("mouseleave",P),r.addEventListener("click",M),$(".search-result").appendChild(r)})}function b(t){const e=this.getAttribute("data-key"),r=p(e);var o=n(r.geometry.coordinates,2);const a=o[0],i=o[1],s=new google.maps.Marker({position:{lat:i,lng:a},label:h()?"A":"B",map:JRP.map});JRP.tempMarkers[e]=s;const c=this.$(".name-primary").textContent;h()?$(".state-start").textContent=c:$(".state-end").textContent=c}function P(t){const e=this.getAttribute("data-key");JRP.tempMarkers[e]&&(JRP.tempMarkers[e].setMap(null),delete JRP.tempMarkers[e])}function M(t){const e=this.getAttribute("data-key");var r;h()?(r=e,JRP.state.startStation=r,JRP.state.startFeature=p(r),JRP.state.startObject=JRP.tempMarkers[r],delete JRP.tempMarkers[r],$(".state-start").textContent=this.$(".name-primary").textContent):(!function(t){JRP.state.endStation=t,JRP.state.endFeature=p(t),JRP.state.endObject=JRP.tempMarkers[t],delete JRP.tempMarkers[t]}(e),$(".state-end").textContent=this.$(".name-primary").textContent,w(JRP.state.lineFeatures,JRP.state.startFeature,JRP.state.endFeature),x())}function x(){l(),$(".search-state").$hide(),$(".state-current").textContent="",$(".state-start").textContent="",$(".state-end").textContent="",$(".search-input input").value="",$(".search-input input").addEventListener("input",g),$(".search-input input").removeAttribute("disabled"),$(".search-result").innerHTML=""}function w(t,e,r){const n=u(t,e,r);if(!1===n)return alert("Unable to find a route"),void x();const o=JRP.plots.length,a={coordinates:n,properties:{lineName:t[0].properties.lineName,company:t[0].properties.company,start:e.properties.groupId,startName:e.properties.stationName,end:r.properties.groupId,endName:r.properties.stationName,color:"#000000",width:1},object:new google.maps.Polyline({path:n.map(([t,e])=>({lat:e,lng:t})),strokeColor:"#000000",strokeWeight:1,map:JRP.map})};JRP.plots.push(a);const i=function(t,e){const r=_make("span",{class:"name-primary"});r.textContent=t;const n=_make("span",{class:"name-secondary"});n.textContent=e;const o=_make("button",{class:"action-delete"});o.textContent="삭제";const a=_make("button",{class:"action-color"});a.innerHTML="색 (<var>#000000</var>)";const i=_make("button",{class:"action-width"});i.innerHTML="두께 (<var>1</var>)";const s=_make("div",{class:"plot-controls"});s.appendChild(o),s.appendChild(a),s.appendChild(i);const c=_make("li",{class:"item-item plot-item"});return c.appendChild(r),c.appendChild(n),c.appendChild(s),c}(a.properties.lineName,a.properties.startName+" → "+a.properties.endName);return i.setAttribute("data-index",o),i.$(".action-delete").addEventListener("click",E),i.$(".action-color").addEventListener("click",k),i.$(".action-width").addEventListener("click",R),$(".plot-list").appendChild(i),o}function E(t){const e=this.parentNode.parentNode,r=parseInt(e.getAttribute("data-index"));log("delete",r),e.parentNode.removeChild(e);for(let t=r+1;t<JRP.plots.length;t++)log("index",t),$(".plot-item[data-index='"+t+"']").setAttribute("data-index",t-1);JRP.plots[r].object.setMap(null),JRP.plots.splice(r,1)}function k(t,e){"number"!=typeof t&&(t=parseInt(this.parentNode.parentNode.getAttribute("data-index"))),"string"!=typeof e&&(e=prompt("새로운 색상 (#xxxxxx 형태)").trim()),e&&/^#[0-9a-f]{6}$/i.test(e)&&(JRP.plots[t].object.set("strokeColor",e),JRP.plots[t].properties.color=e,$(".plot-item[data-index='"+t+"'] .action-color var").textContent=e)}function R(t,e){"number"!=typeof t&&(t=parseInt(this.parentNode.parentNode.getAttribute("data-index"))),"number"!=typeof e&&(e=parseFloat(prompt("새로운 너비 (숫자)").trim())),e&&!Number.isNaN(e)&&(JRP.plots[t].object.set("strokeWeight",e),JRP.plots[t].properties.width=e,$(".plot-item[data-index='"+t+"'] .action-width var").textContent=e)}function J(){const t=JSON.stringify(JRP.plots.map(t=>t.properties)),e=a.compressToBase64(t);$(".modal-export-jrp").$show(),$(".modal-export-jrp textarea").value=e,$(".modal-export-jrp textarea").select()}function A(){$(".modal-import-jrp").$show(),$(".modal-import-jrp textarea").value="",$(".modal-import-jrp textarea").focus()}function C(){const t=$(".modal-import-jrp textarea").value.trim();if(""===t)return;const e=a.decompressFromBase64(t);null===e&&alert("올바르지 않은 데이터입니다.");try{const t=JSON.parse(e);for(const e of t){const t=(r=e.lineName,n=e.company,o=e.start,i=e.end,w(f(r,n),p(o),p(i)));k(t,e.color),R(t,e.width)}}catch(t){alert("올바르지 않은 데이터입니다."),log(t),log(e)}var r,n,o,i}function j(){const t=[];JRP.plots.forEach(e=>{t.push(`${e.properties.company} - ${e.properties.lineName} - `+`${e.properties.startName} -> ${e.properties.endName}`),t.push(google.maps.geometry.encoding.encodePath(e.object.getPath()))});const e=t.join("\n");$(".modal-export-polyline").$show(),$(".modal-export-polyline textarea").value=e,$(".modal-export-polyline textarea").select()}function L(){$("body").classList.add("hide-hover")}function S(){$("body").classList.remove("hide-hover")}window.JRP={state:{},plots:[],tempPolylines:{},tempMarkers:{}},async function(){$(".loading").$show(),await async function(){const t=JSON.parse(localStorage.getItem("revision"))||{railroad:0,station:0},e=localStorage.getItem("railroad"),r=localStorage.getItem("station");if(t.railroad<s||!e){log("railroad cache is outdated, downloading");const t=await(await fetch("data/japan-railway-railroad.json?r="+s)).text();JRP.railroad=JSON.parse(t),log("saving railroad cache, compressing");const e=a.compressToUTF16(t);localStorage.setItem("railroad",e)}else{log("railroad cache is up to date, decompressing");const t=a.decompressFromUTF16(e);JRP.railroad=JSON.parse(t)}if(t.station<c||!r){log("station cache is outdated, downloading");const t=await(await fetch("data/japan-railway-station.json?r="+c)).text();JRP.station=JSON.parse(t),log("saving station cache, compressing");const e=a.compressToUTF16(t);localStorage.setItem("station",e)}else{log("station cache is up to date, decompressing");const t=a.decompressFromUTF16(r);JRP.station=JSON.parse(t)}log("JRP data loaded");const n={railroad:s,station:c};localStorage.setItem("revision",JSON.stringify(n)),log("JRP data converting"),JRP.railroads=o.feature(JRP.railroad,JRP.railroad.objects.railroads),JRP.stations=o.feature(JRP.station,JRP.station.objects.stations),log("everything has loaded, ready to go!")}(),function(){const t=location.hostname,e="https://maps.googleapis.com/maps/api/js?libraries=geometry",r=document.createElement("script");r.type="text/javascript","localhost"===t?r.src=e:t.match(/snack\.studio$/)?r.src=e+"&key=AIzaSyDXfYkzPkfNqI8ZjHsgzuraxhOjMsPg-O8":r.src=e,r.addEventListener("load",function(){JRP.map=new google.maps.Map($("#google-map"),{center:{lat:37,lng:137},zoom:5})}),document.head.appendChild(r)}(),$(".search-input input").addEventListener("input",g),$(".state-cancel").addEventListener("click",x),$$(".modal .modal-close").forEach(t=>t.addEventListener("click",function(){this.parentNode.parentNode.$hide()})),$(".import-jrp").addEventListener("click",A),$(".modal-action-import-jrp").addEventListener("click",C),$(".export-jrp").addEventListener("click",J),$(".export-polyline").addEventListener("click",j),$(".button-hide-hover").addEventListener("click",L),$(".button-show-hover").addEventListener("click",S),$(".loading").$hide()}().then(()=>{}).catch(t=>{console.error(t)})}]);